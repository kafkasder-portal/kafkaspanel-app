import{u as e,b as a,E as t}from"./jspdf.plugin.autotable-DrQwAAop.js";const i=t=>{const{filename:i,sheetName:r="Sheet1",columns:l,data:d,includeTimestamp:n=!0}=t,o=[l.map(e=>e.label),...d.map(e=>l.map(a=>{const t=e[a.key];return a.formatter?a.formatter(t):t}))],s=e.aoa_to_sheet(o),m=l.map(e=>({wch:e.width||15}));s["!cols"]=m;const h=e.book_new();e.book_append_sheet(h,s,r);const u=n?`_${(new Date).toISOString().split("T")[0]}`:"";a(h,`${i}${u}.xlsx`)},r=(e,a)=>{i({filename:a?"beneficiaries_filtered":"beneficiaries",sheetName:"Yararlanıcılar",columns:[{key:"id",label:"ID",width:10},{key:"name",label:"Ad Soyad",width:25},{key:"email",label:"E-posta",width:30},{key:"phone",label:"Telefon",width:20},{key:"address",label:"Adres",width:40},{key:"status",label:"Durum",width:15},{key:"created_at",label:"Oluşturulma Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""}],data:e})},l=(e,a)=>{i({filename:a?"applications_filtered":"applications",sheetName:"Başvurular",columns:[{key:"id",label:"ID",width:10},{key:"applicant_name",label:"Başvuran",width:25},{key:"type",label:"Başvuru Türü",width:20},{key:"status",label:"Durum",width:15},{key:"amount",label:"Tutar",width:15,formatter:e=>e?`${e} TL`:""},{key:"description",label:"Açıklama",width:40},{key:"created_at",label:"Başvuru Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""},{key:"updated_at",label:"Güncelleme Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""}],data:e})},d=(e,a)=>{i({filename:a?"donations_filtered":"donations",sheetName:"Bağışlar",columns:[{key:"id",label:"ID",width:10},{key:"donor_name",label:"Bağışçı",width:25},{key:"amount",label:"Tutar",width:15,formatter:e=>`${e} TL`},{key:"currency",label:"Para Birimi",width:15},{key:"type",label:"Bağış Türü",width:20},{key:"status",label:"Durum",width:15},{key:"description",label:"Açıklama",width:40},{key:"donation_date",label:"Bağış Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""},{key:"created_at",label:"Kayıt Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""}],data:e})},n=e=>{const{title:a,subtitle:i,columns:r,data:l,filename:d,includeTimestamp:n=!0}=e,o=new t;o.setFontSize(18),o.text(a,14,22);let s=30;i&&(o.setFontSize(12),o.text(i,14,s),s+=10),o.setFontSize(10),o.text(`Rapor Tarihi: ${(new Date).toLocaleDateString("tr-TR")}`,14,s),s+=15;const m=r.map(e=>e.header),h=l.map(e=>r.map(a=>{const t=e[a.dataKey];return t instanceof Date?t.toLocaleDateString("tr-TR"):t||""}));o.autoTable({head:[m],body:h,startY:s,styles:{fontSize:8,cellPadding:3},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{top:20}});const u=`${d}${n?`_${(new Date).toISOString().split("T")[0]}`:""}.pdf`;o.save(u)},o=(e,a)=>{n({title:"Yararlanıcılar Listesi",subtitle:a?"Filtrelenmiş Liste":"Tüm Yararlanıcılar",columns:[{header:"ID",dataKey:"id"},{header:"Ad Soyad",dataKey:"name"},{header:"E-posta",dataKey:"email"},{header:"Telefon",dataKey:"phone"},{header:"Durum",dataKey:"status"},{header:"Kayıt Tarihi",dataKey:"created_at"}],data:e,filename:a?"beneficiaries_filtered":"beneficiaries"})},s=(e,a)=>{n({title:"Başvurular Listesi",subtitle:a?"Filtrelenmiş Liste":"Tüm Başvurular",columns:[{header:"ID",dataKey:"id"},{header:"Başvuran",dataKey:"applicant_name"},{header:"Tür",dataKey:"type"},{header:"Durum",dataKey:"status"},{header:"Tutar",dataKey:"amount"},{header:"Başvuru Tarihi",dataKey:"created_at"}],data:e,filename:a?"applications_filtered":"applications"})},m=(e,a)=>{n({title:"Bağışlar Listesi",subtitle:a?"Filtrelenmiş Liste":"Tüm Bağışlar",columns:[{header:"ID",dataKey:"id"},{header:"Bağışçı",dataKey:"donor_name"},{header:"Tutar",dataKey:"amount"},{header:"Para Birimi",dataKey:"currency"},{header:"Tür",dataKey:"type"},{header:"Durum",dataKey:"status"},{header:"Bağış Tarihi",dataKey:"donation_date"}],data:e,filename:a?"donations_filtered":"donations"})};export{m as a,r as b,o as c,l as d,d as e,s as f};
