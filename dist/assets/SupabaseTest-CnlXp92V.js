import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as s}from"./react-vendor-DCtPEfzS.js";import{C as t,B as a}from"./dashboard-DU4k1qlk.js";import{D as r,L as n,s as i,$ as c,y as o,x as l,b1 as d,a0 as m,be as u,W as x}from"./auth-CY9yrbMl.js";import"./file-vendor-D5NpndWQ.js";import"./utils-vendor-DxpoukG0.js";import"./state-vendor-rPBjJaR_.js";import"./chart-vendor-CNXqmhrW.js";import"./supabase-vendor-AMUhAiAi.js";function h(){const[h,p]=s.useState([{name:"Supabase Client Initialization",status:"pending",message:"Testing client setup..."},{name:"Database Connection",status:"pending",message:"Testing database connectivity..."},{name:"Authentication Service",status:"pending",message:"Testing auth service..."},{name:"Table Access",status:"pending",message:"Testing table permissions..."},{name:"Real-time Features",status:"pending",message:"Testing real-time subscriptions..."}]),[g,j]=s.useState(!1),[b,f]=s.useState("pending"),N=(e,s,t,a)=>{p(r=>r.map((r,n)=>n===e?{...r,status:s,message:t,duration:a}:r))},v=s=>{switch(s){case"pending":return e.jsx(n,{className:"h-4 w-4 animate-spin text-blue-500"});case"success":return e.jsx(o,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(c,{className:"h-4 w-4 text-red-500"})}},w=s=>[e.jsx(d,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(r,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(m,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(u,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(x,{className:"h-4 w-4 text-muted-foreground"})][s]||e.jsx(l,{className:"h-4 w-4 text-muted-foreground"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`bg-gradient-to-r ${(()=>{switch(b){case"success":return"from-green-500 to-green-600";case"error":return"from-red-500 to-red-600";default:return"from-blue-500 to-blue-600"}})()} rounded-xl p-6 text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(r,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Supabase Connection Test"})]}),e.jsx("p",{className:"text-white/90",children:"Veritabanı bağlantısı ve servislerin test edilmesi"})]}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v(b),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["success"===b&&"All Systems Operational","error"===b&&"System Issues Detected","pending"===b&&"System Status Check"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["success"===b&&"Supabase services are working properly","error"===b&&"Some services are experiencing issues","pending"===b&&"Testing system components"]})]})]}),e.jsx(a,{onClick:async()=>{j(!0),f("pending");const e=Date.now();try{if(!i)return N(0,"error","Failed to initialize Supabase client"),j(!1),void f("error");N(0,"success","Supabase client initialized successfully",Date.now()-e)}catch(n){return N(0,"error",`Client initialization failed: ${n}`),j(!1),void f("error")}const s=Date.now();try{const{error:e}=await i.from("beneficiaries").select("count",{count:"exact",head:!0}).limit(0);e?N(1,"error",`Database connection failed: ${e.message}`):N(1,"success","Database connected successfully. Tables accessible.",Date.now()-s)}catch(n){N(1,"error",`Database connection error: ${n}`)}const t=Date.now();try{const{data:e,error:s}=await i.auth.getSession();if(s)N(2,"error",`Auth service error: ${s.message}`);else{const s=e?.session?`Authenticated user: ${e.session.user?.email}`:"Auth service working (no active session)";N(2,"success",s,Date.now()-t)}}catch(n){N(2,"error",`Auth service failed: ${n}`)}const a=Date.now();try{const{error:e}=await i.from("beneficiaries").select("id").limit(1),{error:s}=await i.from("applications").select("id").limit(1);if(e||s){N(3,"error",`Table access failed: ${e?.message||s?.message||"Unknown table error"}`)}else N(3,"success","All main tables accessible",Date.now()-a)}catch(n){N(3,"error",`Table access error: ${n}`)}const r=Date.now();try{const e=i.channel("test-channel").on("postgres_changes",{event:"*",schema:"public",table:"beneficiaries"},()=>{}).subscribe(s=>{"SUBSCRIBED"===s?(N(4,"success","Real-time subscriptions working",Date.now()-r),e.unsubscribe()):"CHANNEL_ERROR"===s&&(N(4,"error","Real-time subscription failed"),e.unsubscribe())});setTimeout(()=>{"pending"===h[4].status&&(N(4,"error","Real-time test timeout"),e.unsubscribe())},5e3)}catch(n){N(4,"error",`Real-time error: ${n}`)}setTimeout(()=>{const e=h.some(e=>"error"===e.status);f(e?"error":"success"),j(!1)},6e3)},disabled:g,className:"gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"h-4 w-4 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"h-4 w-4"}),"Run Tests"]})})]})}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Test Results"}),e.jsx("div",{className:"space-y-4",children:h.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w(t),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.message})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.duration&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.duration,"ms"]}),v(s.status)]})]},t))})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Environment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Supabase URL:"}),e.jsx("p",{className:"text-muted-foreground font-mono break-all",children:"your_supabase_url_here"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Environment:"}),e.jsx("p",{className:"text-muted-foreground",children:"production"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"API Key Status:"}),e.jsx("p",{className:"text-muted-foreground",children:"Configured"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Real-time Enabled:"}),e.jsx("p",{className:"text-muted-foreground",children:"No"})]})]})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Setup Instructions"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"1. Environment Variables"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure your .env file with Supabase credentials:"}),e.jsx("pre",{className:"bg-muted p-3 rounded mt-2 overflow-x-auto",children:e.jsx("code",{children:"VITE_SUPABASE_URL=your_supabase_url\nVITE_SUPABASE_ANON_KEY=your_anon_key"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"2. Database Setup"}),e.jsx("p",{className:"text-muted-foreground",children:"Run the migration scripts to create necessary tables:"}),e.jsx("pre",{className:"bg-muted p-3 rounded mt-2",children:e.jsx("code",{children:"npm run db:setup"})})]})]})]})]})}function p(){return e.jsx(h,{})}export{p as default};
