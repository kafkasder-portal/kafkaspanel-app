import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as s}from"./react-vendor-DCtPEfzS.js";import{u as a}from"./meetings-B8BiM5IE.js";import{g as t}from"./index-DWJ42onD.js";import{M as r}from"./messages-Dn-JV80C.js";import{ap as l,X as i,a8 as n,a0 as d,V as o,r as c,ar as m,e as x,U as u,ao as h,bi as p,T as g,i as b,p as j,m as y,aS as f,E as v}from"./auth-ZaPfAXhT.js";import{j as N}from"./dashboard-Bum9Xlfr.js";import"./form-vendor-CfNvelWt.js";import"./state-vendor-rPBjJaR_.js";import"./utils-vendor-DxpoukG0.js";import"./file-vendor-D5NpndWQ.js";import"./supabase-vendor-AMUhAiAi.js";import"./chart-vendor-BDEFy5qM.js";import"./donations-o5PE7GOT.js";function w({isOpen:a,onClose:d,user:o,onRoleChange:c}){const[m,x]=s.useState(o.role),[u,h]=s.useState(""),[p,g]=s.useState(!1),[b,j]=s.useState(null),y=e=>({super_admin:"Sistemin tüm özelliklerine erişim ve tüm yetkileri",admin:"Kullanıcı yönetimi ve sistem ayarları dahil geniş yetkiler",manager:"Departman yönetimi ve onay süreçlerinde yetki",coordinator:"Proje koordinasyonu ve takım yönetimi yetkileri",operator:"Günlük operasyonel işlemler için temel yetkiler",viewer:"Sadece görüntüleme yetkisi, değişiklik yapamaz"}[e]||""),f=e=>({super_admin:"border-red-300 bg-red-50 text-red-800",admin:"border-orange-300 bg-orange-50 text-orange-800",manager:"border-purple-300 bg-purple-50 text-purple-800",coordinator:"border-blue-300 bg-blue-50 text-blue-800",operator:"border-green-300 bg-green-50 text-green-800",viewer:"border-gray-300 bg-gray-50 text-gray-800"}[e]||"border-gray-300 bg-gray-50 text-gray-800"),v=()=>{p||(j(null),x(o.role),h(""),d())};return e.jsx(r,{isOpen:a,onClose:v,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{className:"h-6 w-6 text-purple-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Kullanıcı Rolünü Değiştir"})]}),e.jsx("button",{onClick:v,disabled:p,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:e.jsx(i,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m!==o.role){g(!0),j(null);try{const e=await c(o.id,m,u.trim()||void 0);e.success?d():j(e.error||"Rol değiştirme işlemi başarısız")}catch(s){j(s instanceof Error?s.message:"Beklenmeyen bir hata oluştu")}finally{g(!1)}}else j("Lütfen farklı bir rol seçin")},className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium text-lg",children:o.full_name?.charAt(0)||o.email.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:o.full_name||o.email}),e.jsx("p",{className:"text-sm text-gray-500",children:o.email}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Mevcut Rol: ",e.jsx("span",{className:"font-medium",children:t(o.role)})]})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{className:"h-5 w-5 text-blue-400"}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Bilgi:"})," Rol atama işlevi devre dışı bırakılmıştır. Tüm kullanıcılar otomatik olarak tam yetkiye sahiptir."]})})]})}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:b})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Yeni Rol Seçin"}),e.jsx("div",{className:"space-y-3",children:["super_admin","admin","manager","coordinator","operator","viewer"].map(s=>e.jsxs("label",{className:`relative flex cursor-pointer rounded-lg border p-4 hover:bg-gray-50 ${m===s?f(s):"border-gray-300"} opacity-50 cursor-not-allowed`,children:[e.jsx("input",{type:"radio",name:"role",value:s,checked:m===s,onChange:e=>x(e.target.value),disabled:!0,className:"sr-only"}),e.jsxs("div",{className:"flex w-full items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-5 w-5 rounded-full border-2 flex items-center justify-center "+(m===s?"border-current bg-current":"border-gray-300"),children:m===s&&e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium",children:t(s)}),s===o.role&&e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-600 rounded-full",children:"Mevcut"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-red-100 text-red-600 rounded-full",children:"Yetki Yok"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y(s)})]})]})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Değişiklik Nedeni (Opsiyonel)"}),e.jsx("textarea",{id:"reason",value:u,onChange:e=>h(e.target.value),disabled:p,rows:3,placeholder:"Bu rol değişikliğinin nedenini açıklayın...",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bu bilgi rol değişiklik loglarında saklanacak"})]}),m!==o.role&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{className:"h-5 w-5 text-amber-400"}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("strong",{children:"Dikkat:"})," Rol değişikliği kullanıcının sistem erişim yetkilerini değiştirecek. Bu işlem geri alınamaz ve kullanıcı yeni rolüne göre yetkilendirilecek."]})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:v,disabled:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"İptal"}),e.jsx("button",{type:"submit",disabled:p||m===o.role||!0,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:cursor-not-allowed disabled:opacity-50",children:p?"Güncelleniyor...":"Rolü Değiştir"})]})]})]})})}function k({isOpen:a,onClose:t,user:l,onSave:n}){const[u,h]=s.useState({full_name:l.full_name||"",email:l.email||"",department:l.department||"",phone:l.phone||""}),[p,g]=s.useState(!1),[b,j]=s.useState(null),y=e=>{const{name:s,value:a}=e.target;h(e=>({...e,[s]:a}))},f=()=>{p||(j(null),h({full_name:l.full_name||"",email:l.email||"",department:l.department||"",phone:l.phone||""}),t())};return e.jsx(r,{isOpen:a,onClose:f,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Profil Düzenle"})]}),e.jsx("button",{onClick:f,disabled:p,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:e.jsx(i,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!u.full_name.trim())return void j("Ad Soyad alanı zorunludur");if(!u.email.trim())return void j("E-posta alanı zorunludur");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)){g(!0),j(null);try{const e=await n(l.id,{full_name:u.full_name.trim(),email:u.email.trim(),department:u.department.trim()||null,phone:u.phone.trim()||null});e.success?t():j(e.error||"Profil güncellenirken hata oluştu")}catch(s){j(s instanceof Error?s.message:"Beklenmeyen bir hata oluştu")}finally{g(!1)}}else j("Geçerli bir e-posta adresi giriniz")},className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"h-16 w-16 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium text-xl",children:u.full_name?.charAt(0)||l.email.charAt(0).toUpperCase()})})}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-red-800",children:b})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ad Soyad *"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",id:"full_name",name:"full_name",value:u.full_name,onChange:y,disabled:p,required:!0,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Ad ve soyadınızı giriniz"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"E-posta *"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"email",id:"email",name:"email",value:u.email,onChange:y,disabled:p,required:!0,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"E-posta adresinizi giriniz"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Departman"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",id:"department",name:"department",value:u.department,onChange:y,disabled:p,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Departmanınızı giriniz"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefon"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:u.phone,onChange:y,disabled:p,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Telefon numaranızı giriniz"})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Not:"})," E-posta adresi değişikliği kullanıcının giriş bilgilerini etkileyecektir."]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:f,disabled:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"İptal"}),e.jsxs("button",{type:"submit",disabled:p||!(u.full_name!==(l.full_name||"")||u.email!==(l.email||"")||u.department!==(l.department||"")||u.phone!==(l.phone||"")),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),p?"Kaydediliyor...":"Kaydet"]})]})]})]})})}function _({statistics:s}){const a={super_admin:"text-red-600 bg-red-50 border-red-200",admin:"text-orange-600 bg-orange-50 border-orange-200",manager:"text-purple-600 bg-purple-50 border-purple-200",coordinator:"text-blue-600 bg-blue-50 border-blue-200",operator:"text-green-600 bg-green-50 border-green-200",viewer:"text-gray-600 bg-gray-50 border-gray-200"},r=({title:s,value:a,icon:t,color:r="text-blue-600 bg-blue-50",change:l})=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a}),void 0!==l&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(g,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsxs("span",{className:"text-xs text-green-600",children:["+",l," bu hafta"]})]})]}),e.jsx("div",{className:`p-3 rounded-full ${r}`,children:e.jsx(t,{className:"h-6 w-6"})})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(r,{title:"Toplam Kullanıcı",value:s.total,icon:u,color:"text-blue-600 bg-blue-50",change:s.recentSignups}),e.jsx(r,{title:"Aktif Kullanıcı",value:s.active,icon:h,color:"text-green-600 bg-green-50"}),e.jsx(r,{title:"Pasif Kullanıcı",value:s.inactive,icon:p,color:"text-red-600 bg-red-50"}),e.jsx(r,{title:"Yönetici Sayısı",value:s.byRole.admin+s.byRole.super_admin,icon:l,color:"text-purple-600 bg-purple-50"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Rol Dağılımı"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(s.byRole).map(([r,l])=>e.jsx("div",{className:`p-4 rounded-lg border-2 ${a[r]}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:t(r)}),e.jsx("p",{className:"text-2xl font-bold",children:l})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs",children:s.total>0?`${Math.round(l/s.total*100)}%`:"0%"})})]})},r))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Özet Bilgiler"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Kullanıcı Durumu"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Aktif Rate:"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:s.total>0?`${Math.round(s.active/s.total*100)}%`:"0%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Bu Hafta Yeni:"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:s.recentSignups})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Yetki Dağılımı"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Yönetici:"}),e.jsx("span",{className:"text-sm font-medium text-purple-600",children:s.byRole.admin+s.byRole.super_admin})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Operasyonel:"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:s.byRole.manager+s.byRole.coordinator+s.byRole.operator})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Görüntüleyici:"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s.byRole.viewer})]})]})]})]})]})]})}function C({users:s,canManageUsers:a,onRoleChange:r,onProfileEdit:i,onStatusToggle:n,isUpdating:d}){const o=e=>e?new Date(e).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Hiçbir zaman";return e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kullanıcı"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departman"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durum"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Son Giriş"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kayıt Tarihi"}),a&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(s=>{return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium",children:s.full_name?.charAt(0)||s.email.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.full_name||s.email}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${c=s.role,{super_admin:"text-red-600 bg-red-50",admin:"text-orange-600 bg-orange-50",manager:"text-purple-600 bg-purple-50",coordinator:"text-blue-600 bg-blue-50",operator:"text-green-600 bg-green-50",viewer:"text-gray-600 bg-gray-50"}[c]||"text-gray-600 bg-gray-50"}`,children:t(s.role)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.department||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:s.is_active?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(h,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:"Aktif"})]}):e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(p,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:"Pasif"})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o(s.last_sign_in_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o(s.created_at)}),a&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>i(s),className:"text-indigo-600 hover:text-indigo-900",title:"Profil Düzenle",children:e.jsx(y,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>r(s),className:"text-purple-600 hover:text-purple-900",title:"Rol Değiştir",children:e.jsx(l,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(s.id,!s.is_active),disabled:d,className:`${s.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"} ${d?"opacity-50 cursor-not-allowed":""}`,title:s.is_active?"Pasif Yap":"Aktif Yap",children:s.is_active?e.jsx(f,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})})]})})]},s.id);var c})})]}),0===s.length&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Kullanıcı bulunamadı"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Henüz hiç kullanıcı kaydedilmemiş veya arama kriterlerinize uygun kullanıcı yok."})]})]})}function S(){const{users:r,permissions:l,statistics:i,selectedUser:n,isLoading:d,isUpdating:o,error:c,showRoleModal:m,showProfileModal:x,handleRoleChange:u,handleProfileUpdate:h,handleStatusToggle:p,selectUserForRoleChange:g,selectUserForProfileEdit:y,closeModals:f,search:v,refetchUsers:S}=a(),[R,D]=s.useState("all"),[z,A]=s.useState("all"),U=r.filter(e=>{const s=v.searchQuery.length<=2||e.email.toLowerCase().includes(v.searchQuery.toLowerCase())||e.full_name?.toLowerCase().includes(v.searchQuery.toLowerCase())||e.department?.toLowerCase().includes(v.searchQuery.toLowerCase()),a="all"===R||e.role===R,t="all"===z||"active"===z&&e.is_active||"inactive"===z&&!e.is_active;return s&&a&&t});return d?e.jsx(N,{}):c?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-500 text-sm",children:["Kullanıcı verileri yüklenirken hata oluştu: ",c?.message]}),e.jsx("button",{onClick:()=>S(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Tekrar Dene"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kullanıcı Yönetimi"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Sistem kullanıcılarını yönetin ve rollerini düzenleyin."})]}),e.jsxs("button",{onClick:()=>{const e=[["Ad Soyad","Email","Rol","Departman","Durum","Son Giriş","Kayıt Tarihi"],...U.map(e=>[e.full_name||e.email,e.email,t(e.role),e.department||"",e.is_active?"Aktif":"Pasif",e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString("tr-TR"):"Hiçbir zaman",new Date(e.created_at).toLocaleDateString("tr-TR")])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){const e=URL.createObjectURL(s);a.setAttribute("href",e),a.setAttribute("download",`kullanicilar-${(new Date).toISOString().slice(0,10)}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"CSV İndir"]})]}),i&&e.jsx(_,{statistics:i}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Kullanıcı ara...",value:v.searchQuery,onChange:e=>v.setSearchQuery(e.target.value),className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsx("div",{children:e.jsxs("select",{value:R,onChange:e=>D(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Tüm Roller"}),e.jsx("option",{value:"super_admin",children:"Süper Yönetici"}),e.jsx("option",{value:"admin",children:"Yönetici"}),e.jsx("option",{value:"manager",children:"Müdür"}),e.jsx("option",{value:"coordinator",children:"Koordinatör"}),e.jsx("option",{value:"operator",children:"Operatör"}),e.jsx("option",{value:"viewer",children:"Görüntüleyici"})]})}),e.jsx("div",{children:e.jsxs("select",{value:z,onChange:e=>A(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"active",children:"Aktif"}),e.jsx("option",{value:"inactive",children:"Pasif"})]})}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[U.length," kullanıcı gösteriliyor"]})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200",children:e.jsx(C,{users:U,canManageUsers:!0,onRoleChange:g,onProfileEdit:y,onStatusToggle:p,isUpdating:o})}),m&&n&&e.jsx(w,{isOpen:m,onClose:f,user:n,onRoleChange:u,currentUserRole:l?.profile?.role}),x&&n&&e.jsx(k,{isOpen:x,onClose:f,user:n,onSave:h})]})}export{S as default};
