import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as s}from"./react-vendor-DCtPEfzS.js";import{l as a,p as t,I as r,J as l,K as n,O as i,k as d,X as o,V as c,U as m,F as u,Y as x,M as h,B as g,Z as p,g as f,i as b,_ as j,d as y,y as v,w as N,x as w,q as k,$ as M,E as S,m as C,n as z}from"./auth-ZaPfAXhT.js";import{b as _,d as A,e as E,f as P,g as T}from"./utils-vendor-DxpoukG0.js";import{D as I}from"./donations-o5PE7GOT.js";var W={lessThanXSeconds:{one:"bir saniyeden az",other:"{{count}} saniyeden az"},xSeconds:{one:"1 saniye",other:"{{count}} saniye"},halfAMinute:"yarım dakika",lessThanXMinutes:{one:"bir dakikadan az",other:"{{count}} dakikadan az"},xMinutes:{one:"1 dakika",other:"{{count}} dakika"},aboutXHours:{one:"yaklaşık 1 saat",other:"yaklaşık {{count}} saat"},xHours:{one:"1 saat",other:"{{count}} saat"},xDays:{one:"1 gün",other:"{{count}} gün"},aboutXWeeks:{one:"yaklaşık 1 hafta",other:"yaklaşık {{count}} hafta"},xWeeks:{one:"1 hafta",other:"{{count}} hafta"},aboutXMonths:{one:"yaklaşık 1 ay",other:"yaklaşık {{count}} ay"},xMonths:{one:"1 ay",other:"{{count}} ay"},aboutXYears:{one:"yaklaşık 1 yıl",other:"yaklaşık {{count}} yıl"},xYears:{one:"1 yıl",other:"{{count}} yıl"},overXYears:{one:"1 yıldan fazla",other:"{{count}} yıldan fazla"},almostXYears:{one:"neredeyse 1 yıl",other:"neredeyse {{count}} yıl"}},B={date:_({formats:{full:"d MMMM y EEEE",long:"d MMMM y",medium:"d MMM y",short:"dd.MM.yyyy"},defaultWidth:"full"}),time:_({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:_({formats:{full:"{{date}} 'saat' {{time}}",long:"{{date}} 'saat' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},D={lastWeek:"'geçen hafta' eeee 'saat' p",yesterday:"'dün saat' p",today:"'bugün saat' p",tomorrow:"'yarın saat' p",nextWeek:"eeee 'saat' p",other:"P"},L={code:"tr",formatDistance:function(e,s,a){var t,r=W[e];return t="string"==typeof r?r:1===s?r.one:r.other.replace("{{count}}",s.toString()),null!=a&&a.addSuffix?a.comparison&&a.comparison>0?t+" sonra":t+" önce":t},formatLong:B,formatRelative:function(e,s,a,t){return D[e]},localize:{ordinalNumber:function(e,s){return Number(e)+"."},era:A({values:{narrow:["MÖ","MS"],abbreviated:["MÖ","MS"],wide:["Milattan Önce","Milattan Sonra"]},defaultWidth:"wide"}),quarter:A({values:{narrow:["1","2","3","4"],abbreviated:["1Ç","2Ç","3Ç","4Ç"],wide:["İlk çeyrek","İkinci Çeyrek","Üçüncü çeyrek","Son çeyrek"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:A({values:{narrow:["O","Ş","M","N","M","H","T","A","E","E","K","A"],abbreviated:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],wide:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"]},defaultWidth:"wide"}),day:A({values:{narrow:["P","P","S","Ç","P","C","C"],short:["Pz","Pt","Sa","Ça","Pe","Cu","Ct"],abbreviated:["Paz","Pzt","Sal","Çar","Per","Cum","Cts"],wide:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"]},defaultWidth:"wide"}),dayPeriod:A({values:{narrow:{am:"öö",pm:"ös",midnight:"gy",noon:"ö",morning:"sa",afternoon:"ös",evening:"ak",night:"ge"},abbreviated:{am:"ÖÖ",pm:"ÖS",midnight:"gece yarısı",noon:"öğle",morning:"sabah",afternoon:"öğleden sonra",evening:"akşam",night:"gece"},wide:{am:"Ö.Ö.",pm:"Ö.S.",midnight:"gece yarısı",noon:"öğle",morning:"sabah",afternoon:"öğleden sonra",evening:"akşam",night:"gece"}},defaultWidth:"wide",formattingValues:{narrow:{am:"öö",pm:"ös",midnight:"gy",noon:"ö",morning:"sa",afternoon:"ös",evening:"ak",night:"ge"},abbreviated:{am:"ÖÖ",pm:"ÖS",midnight:"gece yarısı",noon:"öğlen",morning:"sabahleyin",afternoon:"öğleden sonra",evening:"akşamleyin",night:"geceleyin"},wide:{am:"ö.ö.",pm:"ö.s.",midnight:"gece yarısı",noon:"öğlen",morning:"sabahleyin",afternoon:"öğleden sonra",evening:"akşamleyin",night:"geceleyin"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:P({matchPattern:/^(\d+)(\.)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:E({matchPatterns:{narrow:/^(mö|ms)/i,abbreviated:/^(mö|ms)/i,wide:/^(milattan önce|milattan sonra)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(^mö|^milattan önce)/i,/(^ms|^milattan sonra)/i]},defaultParseWidth:"any"}),quarter:E({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^[1234]ç/i,wide:/^((i|İ)lk|(i|İ)kinci|üçüncü|son) çeyrek/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i],abbreviated:[/1ç/i,/2ç/i,/3ç/i,/4ç/i],wide:[/^(i|İ)lk çeyrek/i,/(i|İ)kinci çeyrek/i,/üçüncü çeyrek/i,/son çeyrek/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:E({matchPatterns:{narrow:/^[oşmnhtaek]/i,abbreviated:/^(oca|şub|mar|nis|may|haz|tem|ağu|eyl|eki|kas|ara)/i,wide:/^(ocak|şubat|mart|nisan|mayıs|haziran|temmuz|ağustos|eylül|ekim|kasım|aralık)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^o/i,/^ş/i,/^m/i,/^n/i,/^m/i,/^h/i,/^t/i,/^a/i,/^e/i,/^e/i,/^k/i,/^a/i],any:[/^o/i,/^ş/i,/^mar/i,/^n/i,/^may/i,/^h/i,/^t/i,/^ağ/i,/^ey/i,/^ek/i,/^k/i,/^ar/i]},defaultParseWidth:"any"}),day:E({matchPatterns:{narrow:/^[psçc]/i,short:/^(pz|pt|sa|ça|pe|cu|ct)/i,abbreviated:/^(paz|pzt|sal|çar|per|cum|cts)/i,wide:/^(pazar(?!tesi)|pazartesi|salı|çarşamba|perşembe|cuma(?!rtesi)|cumartesi)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^p/i,/^p/i,/^s/i,/^ç/i,/^p/i,/^c/i,/^c/i],any:[/^pz/i,/^pt/i,/^sa/i,/^ça/i,/^pe/i,/^cu/i,/^ct/i],wide:[/^pazar(?!tesi)/i,/^pazartesi/i,/^salı/i,/^çarşamba/i,/^perşembe/i,/^cuma(?!rtesi)/i,/^cumartesi/i]},defaultParseWidth:"any"}),dayPeriod:E({matchPatterns:{narrow:/^(öö|ös|gy|ö|sa|ös|ak|ge)/i,any:/^(ö\.?\s?[ös]\.?|öğleden sonra|gece yarısı|öğle|(sabah|öğ|akşam|gece)(leyin))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^ö\.?ö\.?/i,pm:/^ö\.?s\.?/i,midnight:/^(gy|gece yarısı)/i,noon:/^öğ/i,morning:/^sa/i,afternoon:/^öğleden sonra/i,evening:/^ak/i,night:/^ge/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:1}};const H=s.createContext(void 0);function O({children:a}){const[t]=s.useState(!1),[r]=s.useState(null),[l]=s.useState(0),n=(e,s)=>{},i=(e,s)=>{},d=(e,s)=>{},o={socket:{emit:n,on:i,off:d},isConnected:t,connectionError:r,reconnectAttempts:l,emit:n,on:i,off:d};return e.jsx(H.Provider,{value:o,children:a})}function Y(){const e=s.useContext(H);if(void 0===e)throw new Error("useSocket must be used within a SocketProvider");return e}const U=({onSelectConversation:l,selectedConversationId:n,currentUserId:i})=>{const[d,o]=s.useState([]),[c,m]=s.useState([]),[u,x]=s.useState(""),[h,g]=s.useState(!0),[p,f]=s.useState(!1),[b,j]=s.useState(""),{socket:y}=Y();s.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("auth_token"),s=await fetch("/api/messages/conversations",{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();o(e.conversations)}}catch(e){}finally{g(!1)}})()},[]),s.useEffect(()=>{if(!p)return;(async()=>{try{const e=localStorage.getItem("auth_token"),s=new URLSearchParams;b&&s.append("search",b);const a=await fetch(`/api/messages/users?${s}`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){const e=await a.json();m(e.users)}}catch(e){}})()},[p,b]),s.useEffect(()=>{if(!y)return;const e=e=>{o(s=>s.map(s=>s.id===e.conversationId?{...s,lastMessage:{content:e.message.content,created_at:e.message.created_at,sender_id:e.message.sender_id},updatedAt:e.message.created_at}:s).sort((e,s)=>new Date(s.updatedAt).getTime()-new Date(e.updatedAt).getTime()))};return y.on("new_message",e),()=>{y.off("new_message",e)}},[y]);const v=d.filter(e=>e.participant.full_name.toLowerCase().includes(u.toLowerCase()));return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-full flex flex-col bg-white border-r border-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Mesajlar"}),e.jsx("button",{onClick:()=>f(!p),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full",children:e.jsx(a,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Sohbetlerde ara...",value:u,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),p&&e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Yeni Sohbet Başlat"}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx(t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Kullanıcı ara...",value:b,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:c.map(s=>e.jsxs("button",{onClick:()=>(async e=>{try{const s=localStorage.getItem("auth_token"),a=await fetch("/api/messages/conversations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({participant_id:e.id})});if(a.ok){const s=await a.json(),t={id:s.conversation.id,participant:e,lastMessage:null,updatedAt:s.conversation.created_at,unreadCount:0};o(e=>[t,...e]),l(t),f(!1),j("")}}catch(s){}})(s),className:"w-full flex items-center space-x-3 p-2 hover:bg-white rounded-lg transition-colors",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.full_name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-sm font-semibold",children:s.full_name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.role})]})]},s.id))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:0===v.length?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(r,{className:"w-12 h-12 mb-4"}),e.jsx("p",{className:"text-sm",children:"Henüz mesajınız yok"}),e.jsx("p",{className:"text-xs",children:"Yeni bir sohbet başlatın"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:v.map(s=>{return e.jsx("button",{onClick:()=>l(s),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors "+(n===s.id?"bg-blue-50 border-r-2 border-blue-600":""),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[s.participant.avatar_url?e.jsx("img",{src:s.participant.avatar_url,alt:s.participant.full_name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:s.participant.full_name.charAt(0).toUpperCase()}),s.unreadCount>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:s.unreadCount})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:s.participant.full_name}),s.lastMessage&&e.jsx("span",{className:"text-xs text-gray-500",children:(a=s.lastMessage.created_at,T(new Date(a),{addSuffix:!1,locale:L}))})]}),s.lastMessage?e.jsxs("p",{className:"text-sm text-gray-600 truncate",children:[s.lastMessage.sender_id===i?"Sen: ":"",s.lastMessage.content]}):e.jsx("p",{className:"text-sm text-gray-400 italic",children:"Henüz mesaj yok"})]})]})},s.id);var a})})})]})};const G=({conversationId:a,participant:t,currentUserId:r,onClose:o})=>{const[c,m]=s.useState([]),[u,x]=s.useState(""),[h,g]=s.useState(!0),p=s.useRef(null),f=s.useRef(null),{socket:b}=Y(),{sendMessage:j,typingUsers:y}=function(){const{isConnected:e,emit:a,on:t,off:r}=Y(),[l,n]=s.useState([]),[i,d]=s.useState([]),o=s.useCallback(e=>{n(s=>[...s,e])},[]),c=s.useCallback(e=>{d(s=>e.isTyping?s.includes(e.userId)?s:[...s,e.userId]:s.filter(s=>s!==e.userId))},[]);return s.useEffect(()=>{if(e)return t("new_message",o),t("user_typing",c),()=>{r("new_message",o),r("user_typing",c)}},[e,t,r,o,c]),{messages:l,typingUsers:i,sendMessage:s.useCallback(e=>{a("send_message",e)},[a]),setTyping:s.useCallback(e=>{a("typing",{isTyping:e})},[a])}}();s.useEffect(()=>{p.current?.scrollIntoView({behavior:"smooth"})},[c]),s.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("auth_token"),s=await fetch(`/api/messages/conversations/${a}/messages`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();m(e.messages)}}catch(e){}finally{g(!1)}})()},[a]),s.useEffect(()=>{if(!b)return;const e=e=>{e.conversationId===a&&m(s=>[...s,e.message])};return b.on("new_message",e),()=>{b.off("new_message",e)}},[b,a]),s.useEffect(()=>{if(!b)return;let e;const s=()=>{b.emit("typing",{conversationId:a,userId:r}),clearTimeout(e),e=setTimeout(()=>{b.emit("stop_typing",{conversationId:a,userId:r})},1e3)},t=f.current;return t?(t.addEventListener("input",s),()=>{t.removeEventListener("input",s),clearTimeout(e)}):void 0},[b,a,r]);return h?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"flex flex-col h-full bg-white rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.full_name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:t.full_name.charAt(0).toUpperCase()}),e.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.full_name}),y.length>0&&e.jsx("p",{className:"text-sm text-blue-600",children:"yazıyor..."})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(l,{className:"w-5 h-5"})}),o&&e.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:"×"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[c.map(s=>{const a=s.sender_id===r;return e.jsx("div",{className:"flex "+(a?"justify-end":"justify-start"),children:e.jsxs("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg "+(a?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:[e.jsx("p",{className:"text-sm",children:s.content}),e.jsx("p",{className:"text-xs mt-1 "+(a?"text-blue-100":"text-gray-500"),children:(t=s.created_at,T(new Date(t),{addSuffix:!0,locale:L}))})]})},s.id);var t}),e.jsx("div",{ref:p})]}),e.jsx("form",{onSubmit:async e=>{if(e.preventDefault(),!u.trim())return;const s=u.trim();x("");try{await j({content:s,userId:"current_user",type:"text"})}catch(a){}},className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(n,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{ref:f,type:"text",value:u,onChange:e=>x(e.target.value),placeholder:"Mesajınızı yazın...",className:"w-full px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(i,{className:"w-5 h-5"})})]}),e.jsx("button",{type:"submit",disabled:!u.trim(),className:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(d,{className:"w-5 h-5"})})]})})]})},K=({currentUserId:a,isOpen:t,onToggle:l})=>{const[n,i]=s.useState(null),{isConnected:d}=Y(),c=e=>{i(e)};return t?e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border border-gray-200 w-96 h-[600px] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{className:"w-5 h-5"}),e.jsx("h2",{className:"font-semibold",children:"Mesajlar"}),!d&&e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-pulse"})]}),e.jsx("button",{onClick:l,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(o,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 flex overflow-hidden",children:n?e.jsxs("div",{className:"w-full flex",children:[e.jsx("div",{className:"w-full md:hidden",children:e.jsx(G,{conversationId:n.id,participant:n.participant,currentUserId:a,onClose:()=>{i(null)}})}),e.jsxs("div",{className:"hidden md:flex w-full",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200",children:e.jsx(U,{onSelectConversation:c,selectedConversationId:n.id,currentUserId:a})}),e.jsx("div",{className:"w-2/3",children:e.jsx(G,{conversationId:n.id,participant:n.participant,currentUserId:a})})]})]}):e.jsx("div",{className:"w-full",children:e.jsx(U,{onSelectConversation:c,currentUserId:a})})}),!d&&e.jsx("div",{className:"p-2 bg-red-50 border-t border-red-200",children:e.jsx("p",{className:"text-xs text-red-600 text-center",children:"Bağlantı kesildi. Yeniden bağlanılıyor..."})})]})}):e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("button",{onClick:l,className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg transition-colors relative",children:[e.jsx(r,{className:"w-6 h-6"}),!d&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]})})};function $({open:a,isOpen:t,title:r,onClose:l,children:n,ariaLabel:i,ariaDescribedBy:d,size:o="medium"}){const c=Boolean(t??a),m=s.useRef(null),u=s.useRef(null),x=s.useCallback(e=>{if(!m.current)return;const s=m.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),a=s[0],t=s[s.length-1];"Tab"===e.key&&(e.shiftKey?document.activeElement===a&&(e.preventDefault(),t?.focus()):document.activeElement===t&&(e.preventDefault(),a?.focus()))},[]);return s.useEffect(()=>{if(c)return u.current=document.activeElement,document.body.style.overflow="hidden",setTimeout(()=>{const e=m.current?.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e?.focus()},10),()=>{document.body.style.overflow="unset",u.current?.focus()}},[c]),s.useEffect(()=>{const e=e=>{"Escape"===e.key&&l()};if(c)return document.addEventListener("keydown",e),document.addEventListener("keydown",x),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keydown",x)}},[c,l,x]),c?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",role:"dialog","aria-modal":"true","aria-label":i||("string"==typeof r?r:"Modal"),"aria-describedby":d,children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:l,"aria-hidden":"true"}),e.jsxs("div",{ref:m,className:"relative z-10 w-full rounded-lg border bg-background p-0 shadow-xl "+("small"===o?"max-w-md":"medium"===o?"max-w-2xl":"large"===o?"max-w-4xl":"xl"===o?"max-w-6xl":"max-w-2xl"),role:"document",children:[r&&e.jsxs("div",{className:"border-b px-4 py-3 text-base font-semibold flex items-center justify-between",children:[e.jsx("h2",{id:"modal-title",children:r}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 text-xl p-1 rounded focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Kapat",type:"button",children:"×"})]}),e.jsx("div",{id:d||"modal-content",children:n})]})]}):null}function X({currentPath:s="/messages"}){const a=[{title:"Mesaj Listesi",href:"/messages",icon:e.jsx(c,{className:"h-4 w-4"}),description:"Tüm mesajları görüntüle ve yönet",isActive:"/messages"===s},{title:"Toplu Gönderim",href:"/messages/bulk-send",icon:e.jsx(d,{className:"h-4 w-4"}),description:"Toplu mesaj gönderimi yap",isActive:"/messages/bulk-send"===s},{title:"Gruplar",href:"/messages/groups",icon:e.jsx(m,{className:"h-4 w-4"}),description:"Mesaj gruplarını yönet",isActive:"/messages/groups"===s},{title:"Şablonlar",href:"/messages/templates",icon:e.jsx(u,{className:"h-4 w-4"}),description:"Mesaj şablonlarını düzenle",isActive:"/messages/templates"===s},{title:"SMS Gönderimleri",href:"/messages/sms-deliveries",icon:e.jsx(x,{className:"h-4 w-4"}),description:"SMS gönderim geçmişi",isActive:"/messages/sms-deliveries"===s},{title:"E-posta Gönderimleri",href:"/messages/email-deliveries",icon:e.jsx(h,{className:"h-4 w-4"}),description:"E-posta gönderim geçmişi",isActive:"/messages/email-deliveries"===s},{title:"Analitik",href:"/messages/analytics",icon:e.jsx(g,{className:"h-4 w-4"}),description:"Mesaj performans raporları",isActive:"/messages/analytics"===s},{title:"Modül Bilgileri",href:"/messages/info",icon:e.jsx(p,{className:"h-4 w-4"}),description:"Modül hakkında bilgi",isActive:"/messages/info"===s}];return e.jsxs("div",{className:"bg-white border rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(c,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Mesaj Yönetimi"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:a.map((s,a)=>e.jsx("a",{href:s.href,className:"group p-3 rounded-lg border transition-all duration-200 hover:shadow-md "+(s.isActive?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg "+(s.isActive?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600 group-hover:bg-gray-200"),children:s.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm "+(s.isActive?"text-blue-900":"text-gray-900"),children:s.title}),e.jsx("p",{className:"text-xs mt-1 leading-relaxed "+(s.isActive?"text-blue-700":"text-gray-600"),children:s.description})]})]})},a))})]})}const R=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[r,l]=s.useState(""),[n,i]=s.useState("all"),[o,c]=s.useState("all"),[m,u]=s.useState("all"),[x,h]=s.useState(null),[g,p]=s.useState(!1),[_,A]=s.useState(!1),E=[],P=s.useMemo(()=>E.filter(e=>{const s=e.subject.toLowerCase().includes(r.toLowerCase())||e.sender.toLowerCase().includes(r.toLowerCase())||e.recipient.toLowerCase().includes(r.toLowerCase()),a="all"===n||e.status===n,t="all"===o||e.type===o,l="all"===m||e.priority===m;return s&&a&&t&&l}),[r,n,o,m,E]),T=s=>{switch(s){case"sent":return e.jsx(d,{className:"h-4 w-4 text-blue-500"});case"delivered":return e.jsx(v,{className:"h-4 w-4 text-green-500"});case"read":return e.jsx(S,{className:"h-4 w-4 text-green-600"});case"failed":return e.jsx(M,{className:"h-4 w-4 text-red-500"});default:return e.jsx(N,{className:"h-4 w-4 text-gray-500"})}},W=s=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${{low:"bg-gray-100 text-gray-800",normal:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"}[s]}`,children:"low"===s?"Düşük":"normal"===s?"Normal":"high"===s?"Yüksek":"Acil"}),B=s=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${{sms:"bg-green-100 text-green-800",email:"bg-blue-100 text-blue-800",notification:"bg-purple-100 text-purple-800"}[s]}`,children:"sms"===s?"SMS":"email"===s?"E-posta":"Bildirim"}),D=[{key:"id",header:"ID",render:(s,a)=>e.jsxs("span",{className:"font-mono text-sm text-gray-600",children:["#",a.id]})},{key:"subject",header:"Konu",render:(s,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[T(a.status),e.jsx("span",{className:"font-medium",children:a.subject})]})},{key:"sender",header:"Gönderen",render:(s,a)=>e.jsx("span",{className:"text-sm",children:a.sender})},{key:"recipient",header:"Alıcı",render:(s,a)=>e.jsx("span",{className:"text-sm",children:a.recipient})},{key:"type",header:"Tür",render:(e,s)=>B(s.type)},{key:"priority",header:"Öncelik",render:(e,s)=>W(s.priority)},{key:"date",header:"Tarih",render:(s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:a.date}),e.jsx("div",{className:"text-gray-500",children:a.time})]})},{key:"actions",header:"İşlemler",render:(s,a)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>(e=>{h(e),p(!0)})(a),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Görüntüle",children:e.jsx(S,{className:"h-4 w-4"})}),e.jsx("button",{className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Düzenle",children:e.jsx(C,{className:"h-4 w-4"})}),e.jsx("button",{className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Sil",children:e.jsx(z,{className:"h-4 w-4"})})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{currentPath:"/messages"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mesaj Listesi"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gönderilmiş ve alınmış mesajları görüntüle ve yönet"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"flex items-center gap-2 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(f,{className:"h-4 w-4"}),"Yenile"]}),e.jsxs("button",{className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(b,{className:"h-4 w-4"}),"Dışa Aktar"]}),e.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(a,{className:"h-4 w-4"}),"Yeni Mesaj"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{value:r,onChange:e=>l(e.target.value),className:"flex-1 border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Konu, gönderen veya alıcı ara..."})]}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filtreler:"})]}),e.jsxs("select",{value:n,onChange:e=>i(e.target.value),className:"border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"sent",children:"Gönderildi"}),e.jsx("option",{value:"delivered",children:"Teslim Edildi"}),e.jsx("option",{value:"read",children:"Okundu"}),e.jsx("option",{value:"failed",children:"Başarısız"})]}),e.jsxs("select",{value:o,onChange:e=>c(e.target.value),className:"border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"all",children:"Tüm Türler"}),e.jsx("option",{value:"sms",children:"SMS"}),e.jsx("option",{value:"email",children:"E-posta"}),e.jsx("option",{value:"notification",children:"Bildirim"})]}),e.jsxs("select",{value:m,onChange:e=>u(e.target.value),className:"border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"all",children:"Tüm Öncelikler"}),e.jsx("option",{value:"low",children:"Düşük"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"Yüksek"}),e.jsx("option",{value:"urgent",children:"Acil"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg",children:[e.jsx(y,{className:"h-4 w-4 text-gray-400"}),e.jsxs("select",{className:"bg-transparent border-0 text-sm focus:outline-none",children:[e.jsx("option",{value:"today",children:"Bugün"}),e.jsx("option",{value:"week",children:"Bu Hafta"}),e.jsx("option",{value:"month",children:"Bu Ay"}),e.jsx("option",{value:"all",children:"Tüm Zamanlar"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(d,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Toplam Mesaj"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Son 30 gün"})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(v,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Başarılı"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.filter(e=>"delivered"===e.status||"read"===e.status).length}),e.jsxs("p",{className:"text-xs text-gray-500",children:["%",(E.filter(e=>"delivered"===e.status||"read"===e.status).length/E.length*100).toFixed(1)]})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(N,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Beklemede"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.filter(e=>"sent"===e.status).length}),e.jsx("p",{className:"text-xs text-gray-500",children:"İşleniyor"})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(w,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Başarısız"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.filter(e=>"failed"===e.status).length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tekrar denenecek"})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(k,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Acil"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.filter(e=>"urgent"===e.priority).length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Öncelikli"})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border",children:e.jsx(I,{columns:D,data:P})}),e.jsx($,{isOpen:g,onClose:()=>p(!1),title:"Mesaj Detayları",children:x&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Konu"}),e.jsx("p",{className:"text-sm text-gray-900",children:x.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durum"}),e.jsxs("div",{className:"flex items-center gap-2",children:[T(x.status),e.jsx("span",{className:"text-sm",children:"sent"===x.status?"Gönderildi":"delivered"===x.status?"Teslim Edildi":"read"===x.status?"Okundu":"Başarısız"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gönderen"}),e.jsx("p",{className:"text-sm text-gray-900",children:x.sender})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alıcı"}),e.jsx("p",{className:"text-sm text-gray-900",children:x.recipient})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tür"}),B(x.type)]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Öncelik"}),W(x.priority)]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarih"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[x.date," ",x.time]})]}),x.group&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grup"}),e.jsx("p",{className:"text-sm text-gray-900",children:x.group})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mesaj İçeriği"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded border",children:e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:x.content})})]})]})}),e.jsx($,{isOpen:_,onClose:()=>A(!1),title:"Yeni Mesaj Oluştur",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mesaj Türü"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"notification",children:"Bildirim"}),e.jsx("option",{value:"sms",children:"SMS"}),e.jsx("option",{value:"email",children:"E-posta"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Öncelik"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"low",children:"Düşük"}),e.jsx("option",{value:"high",children:"Yüksek"}),e.jsx("option",{value:"urgent",children:"Acil"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alıcı"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Alıcı adı veya grup seçin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Konu"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Mesaj konusu"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mesaj İçeriği"}),e.jsx("textarea",{rows:4,className:"w-full border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Mesaj içeriğini yazın..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"İptal"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Gönder"})]})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{K as C,R as I,$ as M,O as S,X as a,L as l};
