import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as t}from"./react-vendor-DCtPEfzS.js";import{i as a,e as r,s}from"./sanitization-C_isCIdH.js";import{B as i}from"./dashboard-DKXcjRFP.js";import{X as l,e as n,n as d,_ as o,p as c}from"./auth-DDWKT-vG.js";class u{fields;dependencies;groups;validationRules;_visibleFieldsCache;constructor(e,t=[],a=[],r=[]){this.fields=e,this.dependencies=t,this.groups=a,this.validationRules=r}getVisibleFields(e){const t=JSON.stringify(Object.keys(e).sort());if(this._visibleFieldsCache?.key===t)return this._visibleFieldsCache.fields;const a=this.fields.filter(t=>{const a=this.dependencies.find(e=>e.field===t.key);if(!a)return!0;const r=e[a.dependsOn];return this.evaluateCondition(r,a.condition)});return this._visibleFieldsCache={key:t,fields:a},a}getEnabledFields(e){const t=[];return this.fields.forEach(a=>{const r=this.dependencies.find(e=>e.field===a.key&&"enable"===e.action);if(!r)return void t.push(a.key);const s=e[r.dependsOn];this.evaluateCondition(s,r.condition)&&t.push(a.key)}),t}getFieldsToClear(e,t){const a=[];return this.dependencies.forEach(r=>{r.dependsOn===e&&"clear"===r.action&&(this.evaluateCondition(t,r.condition)||a.push(r.field))}),a}validateFilters(e){const t={},a=this.getVisibleFields(e),r=this.getEnabledFields(e);for(const s of a){if(!r.includes(s.key))continue;const a=e[s.key],i=this.validationRules.find(e=>e.field===s.key);if(i)if(i.rules.required&&this.isEmpty(a))t[s.key]=`${s.label} alanı zorunludur`;else if(!this.isEmpty(a)){if("number"==typeof a){if(void 0!==i.rules.min&&a<i.rules.min){t[s.key]=`${s.label} en az ${i.rules.min} olmalıdır`;continue}if(void 0!==i.rules.max&&a>i.rules.max){t[s.key]=`${s.label} en fazla ${i.rules.max} olmalıdır`;continue}}if("string"==typeof a){if(void 0!==i.rules.min&&a.length<i.rules.min){t[s.key]=`${s.label} en az ${i.rules.min} karakter olmalıdır`;continue}if(void 0!==i.rules.max&&a.length>i.rules.max){t[s.key]=`${s.label} en fazla ${i.rules.max} karakter olmalıdır`;continue}}if(i.rules.pattern&&"string"==typeof a){if(!new RegExp(i.rules.pattern).test(a)){t[s.key]=`${s.label} geçerli bir format değil`;continue}}if(i.rules.custom){const r=i.rules.custom(a,e);if(r){t[s.key]=r;continue}}}}return{isValid:0===Object.keys(t).length,errors:t}}getGroupedFields(e){const t=this.getVisibleFields(e),a=[],r=new Set;this.groups.forEach(e=>{const s=t.filter(t=>e.fields.includes(t.key));s.length>0&&(a.push({group:e,fields:s}),s.forEach(e=>r.add(e.key)))});const s=t.filter(e=>!r.has(e.key));return s.length>0&&a.push({group:null,fields:s}),a}applyFilterChange(e,t,a){const r={...e,[t]:a};return this.getFieldsToClear(t,a).forEach(e=>{delete r[e]}),r}buildQueryParams(e){const t={},a=this.getVisibleFields(e),r=this.getEnabledFields(e),s=Object.entries(e).filter(([,e])=>!this.isEmpty(e));for(const i of a){if(!r.includes(i.key))continue;const e=s.find(([e])=>e===i.key);if(!e)continue;const[,a]=e;switch(i.type){case"multiSelect":Array.isArray(a)&&a.length>0&&(t[i.key]=a);break;case"dateRange":a&&a.start&&a.end&&(t[`${i.key}_start`]=a.start,t[`${i.key}_end`]=a.end);break;case"numberRange":!a||void 0===a.min&&void 0===a.max||(void 0!==a.min&&(t[`${i.key}_min`]=a.min),void 0!==a.max&&(t[`${i.key}_max`]=a.max));break;default:t[i.key]=a}}return t}evaluateCondition(e,t){const{operator:a,value:r}=t;switch(a){case"equals":return e===r;case"not_equals":return e!==r;case"contains":return"string"==typeof e&&"string"==typeof r&&e.includes(r);case"not_contains":return"string"==typeof e&&"string"==typeof r&&!e.includes(r);case"greater_than":return"number"==typeof e&&"number"==typeof r&&e>r;case"less_than":return"number"==typeof e&&"number"==typeof r&&e<r;case"in":return Array.isArray(r)&&r.includes(e);case"not_in":return Array.isArray(r)&&!r.includes(e);default:return!1}}isEmpty(e){return null==e||""===e||(Array.isArray(e)?0===e.length:"object"==typeof e&&(0===Object.keys(e).length||Object.values(e).every(e=>null==e||""===e)))}resetFilters(){const e={};return this.fields.forEach(t=>{switch(t.type){case"multiSelect":e[t.key]=void 0!==t.defaultValue?t.defaultValue:[];break;case"numberRange":case"dateRange":e[t.key]=void 0!==t.defaultValue?t.defaultValue:{};break;default:e[t.key]=void 0!==t.defaultValue?t.defaultValue:""}}),e}static resetFilters(e){const t={};return e.forEach(e=>{switch(e.type){case"multiSelect":t[e.key]=void 0!==e.defaultValue?e.defaultValue:[];break;case"numberRange":case"dateRange":t[e.key]=void 0!==e.defaultValue?e.defaultValue:{};break;default:t[e.key]=void 0!==e.defaultValue?e.defaultValue:""}}),t}static buildFilterQuery(e){const t={};return Object.entries(e).forEach(([e,a])=>{null!=a&&""!==a&&(Array.isArray(a)?a.length>0&&(t[e]=a):"object"==typeof a?a.from&&a.to?(t[`${e}_from`]=a.from,t[`${e}_to`]=a.to):void 0!==a.min||void 0!==a.max?(void 0!==a.min&&(t[`${e}_min`]=a.min),void 0!==a.max&&(t[`${e}_max`]=a.max)):Object.keys(a).length>0&&(t[e]=a):t[e]=a)}),t}static getVisibleFields(e){return e.filter(e=>!1!==e.visible)}static validateFilters(e,t,a=[]){const r={};for(const s of t){const t=e[s.key],a=s.validation;if(a)if(!a.required||t&&""!==t){if(t&&""!==t)if(a.minLength&&"string"==typeof t&&t.length<a.minLength)r[s.key]=`En az ${a.minLength} karakter olmalıdır`;else{if(a.pattern&&"string"==typeof t){if(!new RegExp(a.pattern).test(t)){r[s.key]="Geçerli bir email adresi girin";continue}}if("number"==typeof t){if(void 0!==a.min&&t<a.min){r[s.key]=`Minimum değer ${a.min} olmalıdır`;continue}if(void 0!==a.max&&t>a.max){r[s.key]=`Maksimum değer ${a.max} olmalıdır`;continue}}}}else r[s.key]="Bu alan zorunludur"}for(const s of a)if(s.rules.custom){const t=e[s.field],a=s.rules.custom(t,e);a&&(r[s.field]=a)}return r}static applyDependencies(e,t,a){return e.map(e=>{const r=a.filter(t=>t.field===e.key);if(0===r.length)return{...e,visible:!0,enabled:!0};let s=!1!==e.visible,i=!1!==e.enabled;for(const a of r){const e=t[a.dependsOn],r=u.evaluateCondition(e,a.condition);"show"===a.action?s=s&&r:"hide"===a.action?s=s&&!r:"enable"===a.action?i=i&&r:"disable"===a.action&&(i=i&&!r)}return{...e,visible:s,enabled:i}})}static evaluateCondition(e,t){const{operator:a,value:r}=t;switch(a){case"equals":return e===r;case"not_equals":return e!==r;case"contains":return"string"==typeof e&&"string"==typeof r&&e.includes(r);case"not_contains":return"string"==typeof e&&"string"==typeof r&&!e.includes(r);case"greater_than":return"number"==typeof e&&"number"==typeof r&&e>r;case"less_than":return"number"==typeof e&&"number"==typeof r&&e<r;case"greater_than_or_equal":return"number"==typeof e&&"number"==typeof r&&e>=r;case"less_than_or_equal":return"number"==typeof e&&"number"==typeof r&&e<=r;case"in":return Array.isArray(r)&&r.includes(e);case"not_in":return Array.isArray(r)&&!r.includes(e);case"not_empty":return null!=e&&""!==e;case"empty":return null==e||""===e;default:return!1}}}const m=()=>({fields:[{key:"name",label:"Ad Soyad",type:"text",placeholder:"Yararlanıcı adı ara..."},{key:"status",label:"Durum",type:"select",options:[{value:"active",label:"Aktif"},{value:"inactive",label:"Pasif"},{value:"pending",label:"Beklemede"}]},{key:"categories",label:"Kategoriler",type:"multiSelect",options:[{value:"education",label:"Eğitim"},{value:"health",label:"Sağlık"},{value:"food",label:"Gıda"},{value:"shelter",label:"Barınma"}]},{key:"ageRange",label:"Yaş Aralığı",type:"numberRange",validation:{min:0,max:120}},{key:"registrationDate",label:"Kayıt Tarihi",type:"dateRange"},{key:"priority",label:"Öncelik",type:"select",options:[{value:"high",label:"Yüksek"},{value:"medium",label:"Orta"},{value:"low",label:"Düşük"}]},{key:"hasActiveApplication",label:"Aktif Başvuru Var",type:"select",options:[{value:"true",label:"Evet"},{value:"false",label:"Hayır"}]}],dependencies:[{field:"priority",dependsOn:"status",condition:{operator:"equals",value:"active"},action:"show"}],groups:[{id:"basic",key:"basic",label:"Temel Bilgiler",fields:["name","status","categories"],operator:"AND"},{id:"demographics",key:"demographics",label:"Demografik Bilgiler",fields:["ageRange","registrationDate"],operator:"AND",collapsible:!0,defaultCollapsed:!0},{id:"advanced",key:"advanced",label:"Gelişmiş Filtreler",fields:["priority","hasActiveApplication"],operator:"AND",collapsible:!0,defaultCollapsed:!0}],validationRules:[{field:"ageRange",rules:{custom:e=>{if(e&&"object"==typeof e&&null!==e&&"min"in e&&"max"in e){const t=e;if(t.min&&t.max&&t.min>t.max)return"Minimum yaş maksimum yaştan büyük olamaz"}return null}}}]});class h{config;constructor(e){this.config={paramPrefix:"filter_",encodeValues:!0,excludeEmpty:!0,dateFormat:"iso",...e}}filtersToURL(e){const t=new URLSearchParams;Object.entries(e).forEach(([e,a])=>{if(this.config.excludeEmpty&&this.isEmpty(a))return;const r=this.config.paramPrefix+e,s=this.serializeValue(a);null!==s&&t.set(r,s)});const a=t.toString();return a?`${this.config.baseUrl}?${a}`:this.config.baseUrl}urlToFilters(e){const t={};try{if(!a(e))return{};let i;if(e.startsWith("http://")||e.startsWith("https://"))i=r(e);else{const t="undefined"!=typeof window?window.location.origin:"http://localhost";i=r(e,t)}if(!i)return{};i.searchParams.forEach((e,a)=>{if(a.startsWith(this.config.paramPrefix||"")){const r=a.replace(this.config.paramPrefix||"",""),i=s(e),l=this.deserializeValue(i);null!==l&&(t[r]=l)}})}catch(i){}return t}getCurrentFilters(){return"undefined"==typeof window?{}:this.urlToFilters(window.location.href)}updateBrowserURL(e,t=!1){if("undefined"==typeof window)return;const r=this.filtersToURL(e);(a(r)||r.startsWith("/"))&&(t?window.history.replaceState({},"",r):window.history.pushState({},"",r))}generateShareableURL(e,t){try{const s=this.filtersToURL(e);if(t){if(!a(t))return s;const e=r(s,t);return e?e.toString():s}if("undefined"!=typeof window&&window.location&&window.location.origin){const e=r(s,window.location.origin);return e?e.toString():s}return s}catch(s){return""}}parseShareableURL(e){return this.urlToFilters(e)}createFilteredURL(e,t){const a={...e,...t};return this.filtersToURL(a)}removeFiltersFromURL(e,t){const a={...e};return t.forEach(e=>{delete a[e]}),this.filtersToURL(a)}hasFilters(){const e=this.getCurrentFilters();return Object.keys(e).length>0}clearFiltersFromURL(e=!1){if("undefined"==typeof window)return;const t=this.config.baseUrl;e?window.history.replaceState({},"",t):window.history.pushState({},"",t)}onURLChange(e){if("undefined"==typeof window)return()=>{};const t=()=>{const t=this.getCurrentFilters();e(t)};return window.addEventListener("popstate",t),()=>{window.removeEventListener("popstate",t)}}validateURLFilters(e,t){const a={};return Object.entries(e).forEach(([e,r])=>{t.includes(e)&&(a[e]=r)}),a}serializeValue(e){if(this.isEmpty(e))return null;try{if("string"==typeof e)return this.config.encodeValues?encodeURIComponent(e):e;if("number"==typeof e||"boolean"==typeof e)return String(e);if(e instanceof Date)switch(this.config.dateFormat){case"timestamp":return String(e.getTime());case"date":return e.toISOString().split("T")[0];default:return e.toISOString()}if(Array.isArray(e)){const t=e.filter(e=>!this.isEmpty(e)).map(e=>this.serializeValue(e)).filter(e=>null!==e);return t.length>0?t.join(","):null}if("object"==typeof e&&null!==e){if("start"in e&&"end"in e&&e.start&&e.end){const t=this.serializeValue(e.start),a=this.serializeValue(e.end);return t&&a?`${t}|${a}`:null}if("min"in e||"max"in e){const t="min"in e&&void 0!==e.min?String(e.min):"";return`${t}|${"max"in e&&void 0!==e.max?String(e.max):""}`}return JSON.stringify(e)}return String(e)}catch(t){return null}}deserializeValue(e){if(!e)return null;try{const t=this.config.encodeValues?decodeURIComponent(e):e;if(t.includes(",")&&!t.includes("|"))return t.split(",").map(e=>{const t=e.trim();return this.parseSimpleValue(t)});if(t.includes("|")){const[e,a]=t.split("|");return this.isDateString(e)||this.isDateString(a)?{start:e?this.parseDate(e):null,end:a?this.parseDate(a):null}:this.isNumeric(e)||this.isNumeric(a)?{min:e?Number(e):void 0,max:a?Number(a):void 0}:{start:e||null,end:a||null}}return t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")?JSON.parse(t):this.parseSimpleValue(t)}catch(t){return e}}parseSimpleValue(e){return"true"===e||"false"!==e&&(this.isNumeric(e)?Number(e):this.isDateString(e)?this.parseDate(e):e)}parseDate(e){try{if("timestamp"===this.config.dateFormat&&this.isNumeric(e))return new Date(Number(e));const t=new Date(e);return isNaN(t.getTime())?null:t}catch{return null}}isNumeric(e){return!isNaN(Number(e))&&!isNaN(parseFloat(e))}isDateString(e){if(!e)return!1;if(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?)?$/.test(e))return!0;if("timestamp"===this.config.dateFormat&&this.isNumeric(e)){const t=Number(e);return t>0&&t<2*Date.now()}return!1}isEmpty(e){return null==e||""===e||(Array.isArray(e)?0===e.length:"object"==typeof e&&(0===Object.keys(e).length||Object.values(e).every(e=>null==e||""===e)))}}const g=()=>({baseUrl:"/beneficiaries",paramPrefix:"bf_",encodeValues:!0,excludeEmpty:!0,dateFormat:"iso"});class f{config;storageKey;constructor(e){this.config={maxSavedFilters:50,enableCloud:!1,...e},this.storageKey=e.userId?`${e.storageKey}_${e.userId}`:e.storageKey}async saveFilter(e){const t=await this.getSavedFilters();if(t.length>=(this.config.maxSavedFilters||50))throw new Error(`Maksimum ${this.config.maxSavedFilters} adet filtre kaydedebilirsiniz`);if(t.some(t=>t.name===e.name&&t.pageType===e.pageType))throw new Error("Bu isimde bir filtre zaten mevcut");const a={...e,id:this.generateId(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()},r=[...t,a];return await this.storeSavedFilters(r),a}async getSavedFilters(e){try{const t=localStorage.getItem(this.storageKey),a=t?JSON.parse(t):[];return e?a.filter(t=>t.pageType===e):a}catch(t){return[]}}async getSavedFilter(e){return(await this.getSavedFilters()).find(t=>t.id===e)||null}async updateSavedFilter(e,t){const a=await this.getSavedFilters(),r=a.findIndex(t=>t.id===e);if(-1===r)throw new Error("Filtre bulunamadı");if(t.name&&t.name!==a[r].name){if(a.some((e,s)=>s!==r&&e.name===t.name&&e.pageType===a[r].pageType))throw new Error("Bu isimde bir filtre zaten mevcut")}const s={...a[r],...t,updatedAt:(new Date).toISOString()};return a[r]=s,await this.storeSavedFilters(a),s}async deleteSavedFilter(e){const t=await this.getSavedFilters(),a=t.filter(t=>t.id!==e);return a.length!==t.length&&(await this.storeSavedFilters(a),!0)}async loadSavedFilter(e){const t=await this.getSavedFilter(e);return t?(await this.updateSavedFilter(e,{usageCount:t.usageCount+1,lastUsed:(new Date).toISOString()}),t):null}async getRecentFilters(e,t=5){return(await this.getSavedFilters(e)).filter(e=>e.usageCount>0).sort((e,t)=>new Date(t.lastUsed).getTime()-new Date(e.lastUsed).getTime()).slice(0,t)}async getPopularFilters(e,t=5){return(await this.getSavedFilters(e)).filter(e=>e.usageCount>0).sort((e,t)=>t.usageCount-e.usageCount).slice(0,t)}async searchSavedFilters(e,t){const a=await this.getSavedFilters(t),r=e.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(r)||e.description&&e.description.toLowerCase().includes(r))}async exportSavedFilters(e){const t=await this.getSavedFilters(e);return JSON.stringify(t,null,2)}async importSavedFilters(e,t=!1){try{const a=JSON.parse(e);if(!Array.isArray(a))throw new Error("Geçersiz veri formatı");const r=await this.getSavedFilters();let s;if(t)s=a.map(e=>({...e,id:this.generateId(),createdAt:e.createdAt,updatedAt:(new Date).toISOString(),lastUsed:e.lastUsed}));else{const e=new Set(r.map(e=>`${e.name}_${e.pageType}`)),t=a.filter(t=>!e.has(`${t.name}_${t.pageType}`));s=[...r,...t.map(e=>({...e,id:this.generateId(),createdAt:e.createdAt,updatedAt:(new Date).toISOString(),lastUsed:e.lastUsed}))]}return await this.storeSavedFilters(s),t?a.length:s.length-r.length}catch(a){throw new Error("Filtreler içe aktarılırken hata oluştu: "+a.message)}}async clearAllSavedFilters(e){if(e){const t=await this.getSavedFilters(),a=t.filter(t=>t.pageType!==e),r=t.length-a.length;return await this.storeSavedFilters(a),r}{const e=(await this.getSavedFilters()).length;return localStorage.removeItem(this.storageKey),e}}async getStorageStats(){const e=await this.getSavedFilters(),t=JSON.stringify(e).length,a={};let r,s;return e.forEach(e=>{a[e.pageType]=(a[e.pageType]||0)+1,(!r||e.createdAt<r)&&(r=e.createdAt),(!s||e.createdAt>s)&&(s=e.createdAt)}),{totalFilters:e.length,totalSize:t,filtersByPage:a,oldestFilter:r,newestFilter:s}}async storeSavedFilters(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw new Error("Filtreler kaydedilirken hata oluştu: "+t.message)}}generateId(){return`filter_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}const p=t.memo(function({isOpen:a,onClose:r,onApplyFilters:s,fields:m,initialFilters:g={},savedFilters:p=[],quickFilters:y=[],onSaveFilter:x,onDeleteFilter:b,onLoadFilter:v,title:k="Gelişmiş Arama",pageType:j,enableURLSync:w=!0,enableExport:N=!1,onExport:S,dependencies:F=[],groups:C=[],validationRules:A=[],urlConfig:O,savedFiltersConfig:E}){const[R,D]=t.useState(g),[$,T]=t.useState(""),[U,_]=t.useState(!1),[z,L]=t.useState("filters"),[V,I]=t.useState({}),[q,B]=t.useState(!1),[K,M]=t.useState(null),P=t.useMemo(()=>new u(m,F,C,A),[m,F,C,A]),J=t.useMemo(()=>O?new h(O):null,[O]),G=t.useMemo(()=>E?new f(E):null,[E]);t.useEffect(()=>{a&&D(g)},[a,g]),t.useEffect(()=>{if(w&&a&&J){const e=J.getCurrentFilters(),{errors:t}=P.validateFilters(e);Object.keys(t).length>0&&D(t=>({...t,...e}))}},[a,w,J,P,m]),t.useEffect(()=>{if(!w||!J)return;return J.onURLChange(e=>{const{errors:t}=P.validateFilters(e);0===Object.keys(t).length&&(D(e),I({}))})},[w,J,P,m]);const H=t.useCallback(e=>{const{errors:t}=P.validateFilters(e);return I(t),0===Object.keys(t).length},[P]),W=t.useMemo(()=>function(e,t){let a=null;return function(...r){null!==a&&clearTimeout(a),a=setTimeout(()=>{a=null,e(...r)},t)}}(e=>{w&&J&&J.updateBrowserURL(e,!0)},300),[w,J]),Q=t.useCallback((e,t)=>{const a=P.applyFilterChange(R,e,t);D(a);const r=Object.keys(R).filter(e=>!(e in a));(V[e]||r.some(e=>V[e]))&&I(t=>{const a={...t};return delete a[e],r.forEach(e=>delete a[e]),a}),W(a)},[P,R,V,W]),Y=t.useCallback(async()=>{try{B(!0),M(null),H(R)&&(await s(R),r())}catch(e){M(e instanceof Error?e.message:"Filtreler uygulanırken bir hata oluştu")}finally{B(!1)}},[R,s,r,H]),Z=t.useCallback(()=>{const e={};D(e),I({}),W(e)},[W]),X=t.useCallback(async(e=!1)=>{if($.trim()&&x&&H(R))try{if(B(!0),M(null),G){const t={id:Date.now().toString(),name:$.trim(),filters:R,createdAt:(new Date).toISOString(),pageType:j,isQuickFilter:e,updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()};await G.saveFilter(t)}x({name:$.trim(),description:"",filters:R,pageType:j,isQuickFilter:e||!1,updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()}),T(""),_(!1)}catch(t){M(t instanceof Error?t.message:"Filtre kaydedilirken bir hata oluştu")}finally{B(!1)}},[$,x,H,R,G,j]),ee=e=>{G&&G.loadSavedFilter(e.id),D(e.filters),I({}),W(e.filters),v&&v(e),L("filters")},te=t=>{const a=R[t.key]||("multiSelect"===t.type?[]:"dateRange"===t.type||"numberRange"===t.type?{}:""),r=!!V[t.key],s=P.getVisibleFields(R),i=P.getEnabledFields(R),l=s.some(e=>e.key===t.key),n=i.includes(t.key);if(!l)return null;if(t.conditional&&R[t.conditional.field]!==t.conditional.value)return null;const d="w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white "+(r?"border-red-500":"border-gray-300 dark:border-gray-600");switch(t.type){case"text":case"number":return e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{type:"number"===t.type?"number":"text",placeholder:t.placeholder||t.label,value:a,onChange:e=>Q(t.key,e.target.value),disabled:!n,className:`${d} ${n?"":"bg-gray-100 cursor-not-allowed"}`,min:t.validation?.min,max:t.validation?.max,pattern:t.validation?.pattern}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]});case"select":return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("select",{value:a,onChange:e=>Q(t.key,e.target.value),disabled:!n,className:`${d} ${n?"":"bg-gray-100 cursor-not-allowed"}`,children:[e.jsx("option",{value:"",children:"Tümü"}),t.options?.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]});case"multiSelect":return e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"border rounded-md p-2 max-h-32 overflow-y-auto",children:t.options?.map(r=>e.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[e.jsx("input",{type:"checkbox",checked:Array.isArray(a)&&a.includes(r.value),onChange:e=>{const s=Array.isArray(a)?a:[];e.target.checked?Q(t.key,[...s,r.value]):Q(t.key,s.filter(e=>e!==r.value))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r.label})]},r.value))}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]});case"numberRange":return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min",value:a?.min||"",onChange:e=>Q(t.key,{...a,min:e.target.value}),className:d,min:t.validation?.min,max:t.validation?.max}),e.jsx("input",{type:"number",placeholder:"Max",value:a?.max||"",onChange:e=>Q(t.key,{...a,max:e.target.value}),className:d,min:t.validation?.min,max:t.validation?.max})]}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]});case"dateRange":return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",value:a?.start||"",onChange:e=>Q(t.key,{...a,start:e.target.value}),className:`flex-1 ${d}`,placeholder:"Başlangıç",min:t.validation?.min,max:t.validation?.max}),e.jsx("input",{type:"date",value:a?.end||"",onChange:e=>Q(t.key,{...a,end:e.target.value}),className:`flex-1 ${d}`,placeholder:"Bitiş",min:t.validation?.min,max:t.validation?.max})]}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]});case"date":return e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{type:"date",value:a,onChange:e=>Q(t.key,e.target.value),className:d,min:t.validation?.min,max:t.validation?.max}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]});default:return null}};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{"data-testid":"advanced-search-modal",className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:k}),j&&e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full dark:bg-blue-900 dark:text-blue-200",children:j})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[N&&S&&e.jsx("button",{onClick:()=>S(R,"csv"),className:"px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center space-x-1",children:e.jsx("span",{children:"Dışa Aktar"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(l,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>L("filters"),className:"px-6 py-3 text-sm font-medium border-b-2 "+("filters"===z?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:"Filtreler"}),e.jsxs("button",{onClick:()=>L("saved"),className:"px-6 py-3 text-sm font-medium border-b-2 "+("saved"===z?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:["Kayıtlı Filtreler (",p.length,")"]}),y&&y.length>0&&e.jsx("button",{onClick:()=>L("quick"),className:"px-6 py-3 text-sm font-medium border-b-2 "+("quick"===z?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:"Hızlı Filtreler"})]}),e.jsxs("div",{className:"flex h-[calc(90vh-120px)]",children:["filters"===z&&e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[Object.keys(V).length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg dark:bg-red-900/20 dark:border-red-800",children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-2",children:"Lütfen aşağıdaki hataları düzeltin:"}),e.jsx("ul",{className:"text-sm text-red-700 dark:text-red-300 space-y-1",children:Object.entries(V).map(([t,a])=>e.jsxs("li",{children:["• ",a]},t))})]}),e.jsxs("div",{className:"space-y-6",children:[P.getGroupedFields(R).filter(e=>e.group).map(t=>e.jsxs("div",{className:"space-y-4",children:[t.group.label&&e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:t.group.label}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.fields.map(t=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t.label,t.validation?.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),te(t)]},t.key))})]},t.group.id)),(()=>{const t=P.getGroupedFields(R).flatMap(e=>e.fields.map(e=>e.key)),a=m.filter(e=>!t.includes(e.key));return a.length>0?e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(t=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t.label,t.validation?.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),te(t)]},t.key))})}):null})()]}),x&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:U?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{placeholder:"Filtre adı",value:$,onChange:e=>T(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",onKeyPress:e=>{"Enter"===e.key&&X()}}),e.jsx(i,{onClick:()=>X(),disabled:!$.trim(),children:"Kaydet"}),e.jsx(i,{variant:"outline",onClick:()=>{_(!1),T("")},children:"İptal"})]}):e.jsxs(i,{variant:"outline",onClick:()=>_(!0),className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),"Filtreyi Kaydet"]})})]}),"saved"===z&&e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Kayıtlı Filtreler"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[G&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files?.[0];if(t&&G){const e=new FileReader;e.onload=e=>{try{const t=JSON.parse(e.target?.result);G.importSavedFilters(t)}catch(t){}},e.readAsText(t)}},e.click()},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"İçe Aktar"}),e.jsx("button",{onClick:()=>{const e=G.exportSavedFilters(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`saved-filters-${j}-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(a)},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Dışa Aktar"})]}),e.jsx("button",{onClick:()=>{G&&G.clearAllSavedFilters()},className:"text-sm text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"Tümünü Temizle"})]})]}),p.map(t=>e.jsx("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 group",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>ee(t),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),t.isQuickFilter&&e.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full dark:bg-yellow-900 dark:text-yellow-200",children:"Hızlı"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400 dark:text-gray-500",children:[e.jsxs("span",{children:["Oluşturulma: ",new Date(t.createdAt).toLocaleDateString("tr-TR")]}),t.lastUsed&&e.jsxs("span",{children:["Son kullanım: ",new Date(t.lastUsed).toLocaleDateString("tr-TR")]}),t.usageCount&&e.jsxs("span",{children:["Kullanım: ",t.usageCount]})]})]}),b&&e.jsx("button",{onClick:e=>{e.stopPropagation(),b(t.id)},className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 p-1",children:e.jsx(d,{className:"w-4 h-4"})})]})},t.id)),0===p.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Henüz kayıtlı filtre yok"}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Filtrelerinizi kaydetmek için önce filtre oluşturun"})]})]})}),"quick"===z&&y&&e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Hızlı Filtreler"}),G&&e.jsx("button",{onClick:()=>{if(Object.keys(R).length>0){const e=prompt("Hızlı filtre adı:");e&&(T(e),X(!0))}},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Mevcut Filtreyi Hızlı Filtre Yap"})]}),y.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(t=>e.jsxs("button",{onClick:()=>{ee(t),G&&t.id&&G.loadSavedFilter(t.id)},className:"p-4 text-left bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg hover:from-blue-100 hover:to-indigo-100 transition-all duration-200 dark:from-blue-900/20 dark:to-indigo-900/20 dark:border-blue-700 dark:hover:from-blue-900/30 dark:hover:to-indigo-900/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:t.name}),t.usageCount&&t.usageCount>0&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full dark:bg-blue-800 dark:text-blue-200",children:t.usageCount})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[Object.keys(t.filters).length," filtre"]}),t.lastUsed&&e.jsxs("span",{children:["Son: ",new Date(t.lastUsed).toLocaleDateString("tr-TR")]})]})]},t.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx("p",{className:"mb-4",children:"Hızlı filtre bulunamadı"}),e.jsx("p",{className:"text-sm",children:"Sık kullanılan filtrelerinizi hızlı erişim için kaydedin"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700",children:[K&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md dark:bg-red-900/20 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:K})}),e.jsxs(i,{variant:"outline",onClick:Z,disabled:q,className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4"}),"Filtreleri Temizle"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{"data-testid":"close-modal",variant:"outline",onClick:r,disabled:q,children:"İptal"}),e.jsxs(i,{"data-testid":"apply-filters",onClick:Y,disabled:q,className:"flex items-center gap-2",children:[q?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):e.jsx(c,{className:"h-4 w-4"}),q?"Filtreleniyor...":"Filtrele"]})]})]})]})}):null});export{p as A,m as a,g as c};
