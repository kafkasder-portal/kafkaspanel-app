import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as t,a,L as s}from"./react-vendor-DCtPEfzS.js";import{R as r,e as l,a as i,X as n,Y as d,T as c,B as o,P as m,c as x,d as u}from"./chart-vendor-BDEFy5qM.js";import{c as p}from"./dashboard-CJXjh513.js";import{s as h,U as g,w as b,x as f,y as j,v,z as N,F as y,T as A,d as w}from"./auth-9wZfjiou.js";const R=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function T({requests:a}){const s=t.useMemo(()=>{const e=a.length,t=a.filter(e=>["taslak","gönderildi","işlemde"].includes(e.status)).length,s=a.filter(e=>"onaylandı"===e.approvalStatus).length,r=a.filter(e=>"tamamlandı"===e.status).length,l=a.reduce((e,t)=>e+t.totalAmount,0),i=a.reduce((e,t)=>e+t.paidAmount,0);return{totalRequests:e,pendingRequests:t,approvedRequests:s,completedRequests:r,totalRequestedAmount:l,totalPaidAmount:i,totalRemainingAmount:a.reduce((e,t)=>e+t.remainingAmount,0),totalBeneficiaries:a.reduce((e,t)=>e+t.beneficiaryCount,0),averageRequestAmount:e>0?l/e:0,paymentCompletionRate:l>0?i/l*100:0}},[a]),p=t.useMemo(()=>{const e=a.reduce((e,t)=>(e[t.department]=(e[t.department]||0)+t.totalAmount,e),{});return Object.entries(e).map(([e,t])=>({name:e,value:t}))},[a]),h=t.useMemo(()=>{const e=a.reduce((e,t)=>(e[t.priority]=(e[t.priority]||0)+1,e),{});return Object.entries(e).map(([e,t])=>({name:e,value:t}))},[a]),g=t.useMemo(()=>{const e=a.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{});return Object.entries(e).map(([e,t])=>({name:e,value:t}))},[a]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-600",children:"Toplam Talep"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:s.totalRequests}),e.jsxs("p",{className:"text-xs text-blue-600",children:["Beklemede: ",s.pendingRequests]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-green-600",children:"Toplam Tutar"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[s.totalRequestedAmount.toLocaleString("tr-TR")," ₺"]}),e.jsxs("p",{className:"text-xs text-green-600",children:["Ort: ",s.averageRequestAmount.toLocaleString("tr-TR")," ₺"]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-600",children:"Ödeme Durumu"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:["%",s.paymentCompletionRate.toFixed(1)]}),e.jsxs("p",{className:"text-xs text-yellow-600",children:["Ödenen: ",s.totalPaidAmount.toLocaleString("tr-TR")," ₺"]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-600",children:"Faydalanıcı"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:s.totalBeneficiaries}),e.jsxs("p",{className:"text-xs text-purple-600",children:["Onaylanan: ",s.approvedRequests]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Departmana Göre Analiz"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(l,{data:p,children:[e.jsx(i,{strokeDasharray:"3 3"}),e.jsx(n,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12}),e.jsx(d,{tickFormatter:e=>`${(e/1e3).toFixed(0)}K`,fontSize:12}),e.jsx(c,{formatter:e=>[`${Number(e).toLocaleString("tr-TR")} ₺`,"Tutar"]}),e.jsx(o,{dataKey:"value",fill:"#3B82F6"})]})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Öncelik Dağılımı"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(m,{children:[e.jsx(x,{data:h,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t})=>`${e} (${(t?100*t:0).toFixed(0)}%)`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:h.map((t,a)=>e.jsx(u,{fill:R[a%R.length]},`cell-${a}`))}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border col-span-2",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Durum Analizi"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(l,{data:g,children:[e.jsx(i,{strokeDasharray:"3 3"}),e.jsx(n,{dataKey:"name",fontSize:12}),e.jsx(d,{fontSize:12}),e.jsx(c,{}),e.jsx(o,{dataKey:"value",fill:"#10B981"})]})})]})]})]})}const B=a.memo(({title:t,value:a,accentClass:s="text-financial-primary",icon:r,subtitle:l,trend:i,variant:n="default"})=>{const d="financial"===n,c="compact"===n;return e.jsx("div",{className:p("bg-white rounded-xl shadow-sm border border-financial-gray-200 transition-all duration-200 hover:shadow-md hover:border-financial-gray-300",c?"p-4":"p-6",d&&"bg-gradient-to-br from-white to-financial-gray-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:p("font-medium text-financial-gray-600 mb-1",c?"text-financial-xs":"text-financial-sm",d&&"font-financial tracking-financial-normal"),children:t}),e.jsx("p",{className:p("font-bold mb-1",c?"text-financial-lg":"text-financial-2xl",d?"font-financial-mono tracking-financial-tight":"",s),children:a}),l&&e.jsx("p",{className:p("text-financial-gray-500","text-financial-xs",d&&"font-financial"),children:l}),i&&e.jsxs("div",{className:p("flex items-center mt-2 text-financial-xs font-medium",i.isPositive?"text-status-success":"text-status-error"),children:[e.jsx("span",{className:p("inline-block w-0 h-0 mr-1",i.isPositive?"border-l-[3px] border-r-[3px] border-b-[4px] border-l-transparent border-r-transparent border-b-status-success":"border-l-[3px] border-r-[3px] border-t-[4px] border-l-transparent border-r-transparent border-t-status-error")}),i.isPositive?"+":"",i.value,"%"]})]}),r&&e.jsx("div",{className:p("rounded-lg transition-colors duration-200",c?"p-2":"p-3",d?"bg-financial-gray-100 hover:bg-financial-gray-200":"bg-gray-50 hover:bg-gray-100"),children:e.jsx(r,{className:p(c?"h-4 w-4":"h-6 w-6",s)})})]})})});B.displayName="StatCard";const k=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[a,r]=t.useState({totalBeneficiaries:0,pendingApplications:0,monthlyAidAmount:0,completedAids:0,urgentApplications:0,activeAidRecords:0}),[l,i]=t.useState([]),[n,d]=t.useState(!0);t.useEffect(()=>{c()},[]);const c=async()=>{try{const{count:e,error:t}=await h.from("beneficiaries").select("*",{count:"exact",head:!0}).eq("status","active"),{count:a,error:s}=await h.from("applications").select("*",{count:"exact",head:!0}).eq("status","pending"),{count:l,error:n}=await h.from("applications").select("*",{count:"exact",head:!0}).eq("priority","urgent").eq("status","pending"),d=(new Date).toISOString().slice(0,7),{count:c,error:o}=await h.from("aid_records").select("*",{count:"exact",head:!0}).eq("status","completed").gte("created_at",`${d}-01`),{data:m,error:x}=await h.from("aid_records").select("amount").eq("status","completed").gte("created_at",`${d}-01`),u=m?.reduce((e,t)=>{const a=t.amount||0;return e+(isNaN(a)?0:a)},0)||0,{count:p,error:g}=await h.from("aid_records").select("*",{count:"exact",head:!0}).in("status",["approved","distributed"]),{data:b,error:f}=await h.from("applications").select("\n          *,\n          beneficiaries (name, surname)\n        ").order("created_at",{ascending:!1}).limit(5);r({totalBeneficiaries:e||0,pendingApplications:a||0,monthlyAidAmount:u,completedAids:c||0,urgentApplications:l||0,activeAidRecords:p||0}),i(b||[])}catch(e){r({totalBeneficiaries:0,pendingApplications:0,monthlyAidAmount:0,completedAids:0,urgentApplications:0,activeAidRecords:0}),i([])}finally{d(!1)}},o=e=>isNaN(e)||null==e?"₺0,00":new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(e),m=t=>{const a={pending:{label:"Bekliyor",class:"bg-yellow-100 text-yellow-800"},approved:{label:"Onaylandı",class:"bg-green-100 text-green-800"},rejected:{label:"Reddedildi",class:"bg-red-100 text-red-800"},completed:{label:"Tamamlandı",class:"bg-blue-100 text-blue-800"}}[t]||{label:t,class:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:a.label})},x=t=>{const a={low:{label:"Düşük",class:"bg-gray-100 text-gray-800"},normal:{label:"Normal",class:"bg-blue-100 text-blue-800"},high:{label:"Yüksek",class:"bg-orange-100 text-orange-800"},urgent:{label:"Acil",class:"bg-red-100 text-red-800"}}[t]||{label:t,class:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:a.label})};return n?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Yardım Yönetimi"}),e.jsx("p",{className:"text-muted-foreground",children:"Yardım süreçlerinizi takip edin ve yönetin"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(s,{to:"/aid/applications",className:"rounded bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90",children:"Yeni Başvuru"})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(B,{title:"Toplam İhtiyaç Sahibi",value:a.totalBeneficiaries,icon:g,accentClass:"bg-blue-100"}),e.jsx(B,{title:"Bekleyen Başvurular",value:a.pendingApplications,icon:b,accentClass:"bg-orange-100"}),e.jsx(B,{title:"Acil Başvurular",value:a.urgentApplications,icon:f,accentClass:"bg-red-100"}),e.jsx(B,{title:"Bu Ay Tamamlanan",value:a.completedAids,icon:j,accentClass:"bg-green-100"}),e.jsx(B,{title:"Bu Ay Toplam Tutar",value:o(a.monthlyAidAmount||0),icon:v,accentClass:"bg-purple-100"}),e.jsx(B,{title:"Aktif Yardım Kayıtları",value:a.activeAidRecords,icon:N,accentClass:"bg-indigo-100"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Son Başvurular"}),e.jsx(s,{to:"/aid/applications",className:"text-sm text-primary hover:underline",children:"Tümünü Gör"})]}),e.jsx("div",{className:"space-y-3",children:l.length>0?l.map(t=>{return e.jsxs("div",{className:"flex items-center justify-between rounded border p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium",children:[t.beneficiaries?.name||"İsim"," ",t.beneficiaries?.surname||"Soyisim"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.description||"Açıklama bulunmamaktadır"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[m(t.status||"pending"),x(t.priority||"normal")]})]}),e.jsx("div",{className:"text-right text-sm text-muted-foreground",children:t.created_at?(a=t.created_at,new Date(a).toLocaleDateString("tr-TR")):"Tarih yok"})]},t.id);var a}):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"Henüz başvuru bulunmamaktadır."})})]}),e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Hızlı Erişim"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(s,{to:"/aid/beneficiaries",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[e.jsx(g,{className:"h-8 w-8 text-blue-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"İhtiyaç Sahipleri"})]}),e.jsxs(s,{to:"/aid/applications",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[e.jsx(y,{className:"h-8 w-8 text-orange-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Başvurular"})]}),e.jsxs(s,{to:"/aid/cash-vault",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[e.jsx(v,{className:"h-8 w-8 text-green-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Nakdi Yardım"})]}),e.jsxs(s,{to:"/aid/reports",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[e.jsx(A,{className:"h-8 w-8 text-purple-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Raporlar"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsxs("h2",{className:"mb-4 text-lg font-semibold flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"Bu Ay Özeti"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.completedAids}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Tamamlanan Yardım"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o(a.monthlyAidAmount||0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Toplam Tutar"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:a.pendingApplications}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Bekleyen Başvuru"})]})]})]})]})}},Symbol.toStringTag,{value:"Module"}));export{k as I,T as P,B as S};
