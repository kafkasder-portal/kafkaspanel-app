import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as s}from"./react-vendor-DCtPEfzS.js";import{s as a,i as t,_ as r,v as l,U as i,B as d,T as n}from"./auth-9wZfjiou.js";import{B as c,C as o,n as h,o as x,r as m,I as j,S as u,b as p,s as g,e as y,f as v,T as f,t as N,v as D,w as b}from"./dashboard-CJXjh513.js";import{V as w}from"./meetings-bbWcv5Hc.js";import{R as T,e as k,a as A,X as _,Y as K,T as S,B as Y,P as C,c as B,d as E,g as R,L as F,b as M}from"./chart-vendor-BDEFy5qM.js";import"./state-vendor-rPBjJaR_.js";import"./supabase-vendor-AMUhAiAi.js";import"./file-vendor-D5NpndWQ.js";import"./utils-vendor-DxpoukG0.js";import"./form-vendor-CfNvelWt.js";import"./messages-C4gZlbNu.js";import"./donations-Cc8AcqVz.js";function G(){const[G,L]=s.useState({monthlyAids:[],aidTypeDistribution:[],beneficiaryCategories:[],applicationTrends:[]}),[V,W]=s.useState({startDate:new Date((new Date).getFullYear(),0,1).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],aidType:"all",category:"all"}),[I,O]=s.useState("overview"),P=s.useCallback(async()=>{try{const{data:e}=await a.from("aid_records").select("amount, created_at").gte("created_at",V.startDate).lte("created_at",V.endDate).eq("status","completed"),s=new Map;e?.forEach(e=>{const a=new Date(e.created_at).toLocaleDateString("tr-TR",{year:"numeric",month:"short"});s.has(a)||s.set(a,{month:a,amount:0,count:0});const t=s.get(a);t.amount+=e.amount||0,t.count+=1});const{data:t}=await a.from("aid_records").select("aid_type").gte("created_at",V.startDate).lte("created_at",V.endDate),r=new Map;t?.forEach(e=>{const s=e.aid_type;r.set(s,(r.get(s)||0)+1)});const l=["#8884d8","#82ca9d","#ffc658","#ff7300","#00ff00"],i=Array.from(r.entries()).map(([e,s],a)=>({name:$(e),value:s,color:l[a%l.length]})),{data:d}=await a.from("beneficiaries").select("category").gte("created_at",V.startDate).lte("created_at",V.endDate),n=new Map;d?.forEach(e=>{const s=e.category;n.set(s,(n.get(s)||0)+1)});const c=Array.from(n.entries()).map(([e,s])=>({category:q(e),count:s})),{data:o}=await a.from("applications").select("status, created_at").gte("created_at",V.startDate).lte("created_at",V.endDate),h=new Map;o?.forEach(e=>{const s=new Date(e.created_at).toLocaleDateString("tr-TR",{month:"short",day:"numeric"});h.has(s)||h.set(s,{date:s,pending:0,approved:0,rejected:0});const a=h.get(s);"pending"===e.status?a.pending+=1:"approved"===e.status?a.approved+=1:"rejected"===e.status&&(a.rejected+=1)}),L({monthlyAids:Array.from(s.values()),aidTypeDistribution:i,beneficiaryCategories:c,applicationTrends:Array.from(h.values())})}catch(e){w.error("Rapor verileri yüklenirken hata oluştu")}},[V]);s.useEffect(()=>{P()},[P]);const $=e=>({cash:"Nakit",food:"Gıda",clothing:"Giyim",housing:"Barınma",health:"Sağlık",education:"Eğitim",other:"Diğer"}[e]||e),q=e=>({orphan:"Yetim",widow:"Dul",elderly:"Yaşlı",disabled:"Engelli",refugee:"Mülteci",other:"Diğer"}[e]||e);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Raporlar"}),e.jsx("p",{className:"text-muted-foreground",children:"Yardım ve başvuru istatistikleri"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(c,{variant:"outline",onClick:()=>{w.success("Rapor dışa aktarıldı")},children:[e.jsx(t,{className:"h-4 w-4 mr-2"}),"CSV"]}),e.jsxs(c,{variant:"outline",onClick:()=>{w.success("PDF raporu oluşturuldu")},children:[e.jsx(t,{className:"h-4 w-4 mr-2"}),"PDF"]})]})]}),e.jsxs(o,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(r,{className:"h-5 w-5 mr-2"}),"Filtreler"]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Başlangıç Tarihi"}),e.jsx(j,{type:"date",value:V.startDate,onChange:e=>W(s=>({...s,startDate:e.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Bitiş Tarihi"}),e.jsx(j,{type:"date",value:V.endDate,onChange:e=>W(s=>({...s,endDate:e.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Yardım Türü"}),e.jsxs(u,{value:V.aidType,onValueChange:e=>W(s=>({...s,aidType:e})),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(y,{children:[e.jsx(v,{value:"all",children:"Tümü"}),e.jsx(v,{value:"cash",children:"Nakit"}),e.jsx(v,{value:"food",children:"Gıda"}),e.jsx(v,{value:"clothing",children:"Giyim"}),e.jsx(v,{value:"housing",children:"Barınma"}),e.jsx(v,{value:"health",children:"Sağlık"}),e.jsx(v,{value:"education",children:"Eğitim"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Kategori"}),e.jsxs(u,{value:V.category,onValueChange:e=>W(s=>({...s,category:e})),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(y,{children:[e.jsx(v,{value:"all",children:"Tümü"}),e.jsx(v,{value:"orphan",children:"Yetim"}),e.jsx(v,{value:"widow",children:"Dul"}),e.jsx(v,{value:"elderly",children:"Yaşlı"}),e.jsx(v,{value:"disabled",children:"Engelli"}),e.jsx(v,{value:"refugee",children:"Mülteci"})]})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(l,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Toplam Yardım"}),e.jsxs("p",{className:"text-2xl font-bold",children:[G.monthlyAids.reduce((e,s)=>e+s.amount,0).toLocaleString("tr-TR")," ₺"]})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(i,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Yardım Alan"}),e.jsx("p",{className:"text-2xl font-bold",children:G.monthlyAids.reduce((e,s)=>e+s.count,0)})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(d,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Yardım Türü"}),e.jsx("p",{className:"text-2xl font-bold",children:G.aidTypeDistribution.length})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(n,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Ortalama"}),e.jsxs("p",{className:"text-2xl font-bold",children:[G.monthlyAids.length>0?(G.monthlyAids.reduce((e,s)=>e+s.amount,0)/G.monthlyAids.length).toLocaleString("tr-TR",{maximumFractionDigits:0}):0," ₺"]})]})]})})})]}),e.jsxs(f,{value:I,onValueChange:O,children:[e.jsxs(N,{className:"grid w-full grid-cols-4",children:[e.jsx(D,{value:"overview",children:"Genel Bakış"}),e.jsx(D,{value:"monthly",children:"Aylık Trend"}),e.jsx(D,{value:"distribution",children:"Dağılım"}),e.jsx(D,{value:"applications",children:"Başvurular"})]}),e.jsx(b,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsx(h,{children:e.jsx(x,{children:"Aylık Yardım Dağılımı"})}),e.jsx(m,{children:e.jsx(T,{width:"100%",height:300,children:e.jsxs(k,{data:G.monthlyAids,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"month"}),e.jsx(K,{}),e.jsx(S,{}),e.jsx(Y,{dataKey:"amount",fill:"#8884d8"})]})})})]}),e.jsxs(o,{children:[e.jsx(h,{children:e.jsx(x,{children:"Yardım Türü Dağılımı"})}),e.jsx(m,{children:e.jsx(T,{width:"100%",height:300,children:e.jsxs(C,{children:[e.jsx(B,{data:G.aidTypeDistribution,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,children:G.aidTypeDistribution.map((s,a)=>e.jsx(E,{fill:s.color},`cell-${a}`))}),e.jsx(S,{})]})})})]})]})}),e.jsx(b,{value:"monthly",className:"space-y-6",children:e.jsxs(o,{children:[e.jsx(h,{children:e.jsx(x,{children:"Aylık Yardım Trendi"})}),e.jsx(m,{children:e.jsx(T,{width:"100%",height:400,children:e.jsxs(R,{data:G.monthlyAids,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"month"}),e.jsx(K,{}),e.jsx(S,{}),e.jsx(F,{}),e.jsx(M,{type:"monotone",dataKey:"amount",stroke:"#8884d8",strokeWidth:2}),e.jsx(M,{type:"monotone",dataKey:"count",stroke:"#82ca9d",strokeWidth:2})]})})})]})}),e.jsx(b,{value:"distribution",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsx(h,{children:e.jsx(x,{children:"İhtiyaç Sahibi Kategorileri"})}),e.jsx(m,{children:e.jsx(T,{width:"100%",height:300,children:e.jsxs(k,{data:G.beneficiaryCategories,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"category"}),e.jsx(K,{}),e.jsx(S,{}),e.jsx(Y,{dataKey:"count",fill:"#82ca9d"})]})})})]}),e.jsxs(o,{children:[e.jsx(h,{children:e.jsx(x,{children:"Yardım Türü Detayı"})}),e.jsx(m,{children:e.jsx(T,{width:"100%",height:300,children:e.jsxs(k,{data:G.aidTypeDistribution,layout:"horizontal",children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(_,{type:"number"}),e.jsx(K,{dataKey:"name",type:"category"}),e.jsx(S,{}),e.jsx(Y,{dataKey:"value",fill:"#8884d8"})]})})})]})]})}),e.jsx(b,{value:"applications",className:"space-y-6",children:e.jsxs(o,{children:[e.jsx(h,{children:e.jsx(x,{children:"Başvuru Trendleri"})}),e.jsx(m,{children:e.jsx(T,{width:"100%",height:400,children:e.jsxs(R,{data:G.applicationTrends,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"date"}),e.jsx(K,{}),e.jsx(S,{}),e.jsx(F,{}),e.jsx(M,{type:"monotone",dataKey:"pending",stroke:"#ffc658",strokeWidth:2}),e.jsx(M,{type:"monotone",dataKey:"approved",stroke:"#82ca9d",strokeWidth:2}),e.jsx(M,{type:"monotone",dataKey:"rejected",stroke:"#ff7300",strokeWidth:2})]})})})]})})]})]})}export{G as default};
