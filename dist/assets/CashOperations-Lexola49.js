import{j as e}from"./ui-vendor-B8g4ebjc.js";import{r as t}from"./react-vendor-DCtPEfzS.js";import{e as a,D as s}from"./donations-Cc8AcqVz.js";import{M as r}from"./messages-C4gZlbNu.js";import{S as l}from"./aid-DvwBo_vc.js";import{u as n,b as i,s as o,n as d,e as c}from"./form-vendor-CfNvelWt.js";import{V as m,t as p}from"./meetings-bbWcv5Hc.js";import{l as x,T as u,c as h,b5 as g,d as b,p as j,i as y,b as f,aj as v,X as N,a as k,w,E as _,m as S}from"./auth-9wZfjiou.js";import"./dashboard-CJXjh513.js";import"./file-vendor-D5NpndWQ.js";import"./utils-vendor-DxpoukG0.js";import"./state-vendor-rPBjJaR_.js";import"./chart-vendor-BDEFy5qM.js";import"./supabase-vendor-AMUhAiAi.js";const T=i({operation_type:c(["income","expense","transfer"],{message:"İşlem türü seçiniz"}),amount:d().min(.01,"Geçerli bir tutar giriniz"),description:o().min(1,"Açıklama giriniz"),category:o().min(1,"Kategori seçiniz"),reference_number:o().optional(),from_account:o().optional(),to_account:o().optional(),notes:o().optional()}),D={income:["Bağış Geliri","Faiz Geliri","Kira Geliri","Diğer Gelirler"],expense:["Nakdi Yardım","Personel Gideri","Kira Gideri","Elektrik-Su","Telefon-İnternet","Kırtasiye","Diğer Giderler"],transfer:["Hesap Arası Transfer","Banka Transfer","Kasa Transfer"]};function C(){const[i,o]=t.useState([]),[d,c]=t.useState({totalIncome:0,totalExpense:0,balance:0,todayOperations:0}),[C,G]=t.useState(!0),[E,B]=t.useState(""),[I,Y]=t.useState("all"),[z,A]=t.useState("all"),[K,O]=t.useState("all"),[R,F]=t.useState(!1),[L,H]=t.useState(null),{register:M,handleSubmit:U,formState:{errors:$},reset:P,watch:V}=n({resolver:p(T)}),q=V("operation_type");t.useEffect(()=>{J(),Q()},[]);const J=async()=>{try{const e=[{id:"1",operation_type:"income",amount:5e4,description:"Aylık bağış geliri",category:"Bağış Geliri",reference_number:"REF001",operator_id:"user1",operation_date:(new Date).toISOString(),status:"completed",created_at:(new Date).toISOString(),operator:{name:"Admin User",email:"admin@example.com"}},{id:"2",operation_type:"expense",amount:15e3,description:"Nakdi yardım ödemesi",category:"Nakdi Yardım",reference_number:"REF002",operator_id:"user1",operation_date:(new Date).toISOString(),status:"completed",created_at:(new Date).toISOString(),operator:{name:"Admin User",email:"admin@example.com"}}];o(e)}catch(e){m.error("Nakdi işlemler yüklenirken hata oluştu")}finally{G(!1)}},Q=async()=>{try{c({totalIncome:15e4,totalExpense:85e3,balance:65e3,todayOperations:5})}catch(e){}},W=t.useMemo(()=>i.filter(e=>{const t=""===E||e.description.toLowerCase().includes(E.toLowerCase())||e.category.toLowerCase().includes(E.toLowerCase())||e.reference_number?.toLowerCase().includes(E.toLowerCase()),a="all"===I||e.operation_type===I,s="all"===z||e.status===z;let r=!0;if("all"!==K){const t=new Date(e.operation_date),a=new Date;switch(K){case"today":r=t.toDateString()===a.toDateString();break;case"week":r=t>=new Date(a.getTime()-6048e5);break;case"month":r=t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()}}return t&&a&&s&&r}),[i,E,I,z,K]),X=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(e),Z=[{key:"operation_type",header:"İşlem Türü",render:(t,a)=>(t=>{const a={income:{label:"Gelir",class:"bg-green-100 text-green-800",icon:u},expense:{label:"Gider",class:"bg-red-100 text-red-800",icon:h},transfer:{label:"Transfer",class:"bg-blue-100 text-blue-800",icon:f}}[t]||{label:t,class:"bg-gray-100 text-gray-800",icon:v},s=a.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:[e.jsx(s,{className:"h-3 w-3"}),a.label]})})(a.operation_type)},{key:"description",header:"Açıklama",render:(t,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.category})]})},{key:"amount",header:"Tutar",render:(t,a)=>e.jsxs("div",{className:"font-medium "+("income"===a.operation_type?"text-green-600":"expense"===a.operation_type?"text-red-600":"text-blue-600"),children:["income"===a.operation_type?"+":"expense"===a.operation_type?"-":"",X(a.amount)]})},{key:"reference_number",header:"Referans No",render:(e,t)=>t.reference_number||"-"},{key:"operation_date",header:"İşlem Tarihi",render:(e,t)=>{return a=t.operation_date,new Date(a).toLocaleDateString("tr-TR");var a}},{key:"status",header:"Durum",render:(t,a)=>(t=>{const a={pending:{label:"Beklemede",class:"bg-yellow-100 text-yellow-800",icon:w},completed:{label:"Tamamlandı",class:"bg-green-100 text-green-800",icon:k},cancelled:{label:"İptal Edildi",class:"bg-red-100 text-red-800",icon:N}}[t]||{label:t,class:"bg-gray-100 text-gray-800",icon:k},s=a.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:[e.jsx(s,{className:"h-3 w-3"}),a.label]})})(a.status)},{key:"operator",header:"İşlem Yapan",render:(e,t)=>t.operator?.name||"-"},{key:"actions",header:"İşlemler",render:(t,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:e.jsx(_,{className:"h-4 w-4"})}),"pending"===a.status&&e.jsx("button",{onClick:()=>{H(a),F(!0)},className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Düzenle",children:e.jsx(S,{className:"h-4 w-4"})})]})}];return C?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Nakdi Yardım İşlemleri"}),e.jsx("p",{className:"text-muted-foreground",children:"Nakdi işlemleri kaydedin ve takip edin"})]}),e.jsxs("button",{onClick:()=>{H(null),F(!0)},className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[e.jsx(x,{className:"h-4 w-4"}),"Yeni İşlem"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(l,{title:"Toplam Gelir",value:X(d.totalIncome),icon:u,accentClass:"bg-green-100"}),e.jsx(l,{title:"Toplam Gider",value:X(d.totalExpense),icon:h,accentClass:"bg-red-100"}),e.jsx(l,{title:"Bakiye",value:X(d.balance),icon:g,accentClass:"bg-blue-100"}),e.jsx(l,{title:"Bugünkü İşlemler",value:d.todayOperations.toString(),icon:b,accentClass:"bg-purple-100"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"İşlem ara...",value:E,onChange:e=>B(e.target.value),className:"min-w-64 rounded border px-3 py-2 text-sm"})]}),e.jsxs("select",{value:I,onChange:e=>Y(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Türler"}),e.jsx("option",{value:"income",children:"Gelir"}),e.jsx("option",{value:"expense",children:"Gider"}),e.jsx("option",{value:"transfer",children:"Transfer"})]}),e.jsxs("select",{value:z,onChange:e=>A(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"pending",children:"Bekleyen"}),e.jsx("option",{value:"completed",children:"Tamamlanan"}),e.jsx("option",{value:"cancelled",children:"İptal Edilen"})]}),e.jsxs("select",{value:K,onChange:e=>O(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Tarihler"}),e.jsx("option",{value:"today",children:"Bugün"}),e.jsx("option",{value:"week",children:"Bu Hafta"}),e.jsx("option",{value:"month",children:"Bu Ay"})]}),e.jsxs("button",{onClick:()=>a("nakdi-islemler.csv",W),className:"flex items-center gap-2 rounded bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",children:[e.jsx(y,{className:"h-4 w-4"}),"İndir"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[W.length," işlem"]})]}),e.jsx(s,{columns:Z,data:W}),e.jsxs(r,{open:R,onClose:()=>F(!1),children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:L?"İşlem Düzenle":"Yeni Nakdi İşlem"}),e.jsx("button",{onClick:()=>F(!1),className:"h-8 w-8 rounded-full bg-red-600 text-white hover:bg-red-700",children:"×"})]}),e.jsxs("form",{onSubmit:U(async e=>{try{const t={id:Date.now().toString(),...e,operator_id:"current_user",operation_date:(new Date).toISOString(),status:"completed",created_at:(new Date).toISOString(),operator:{name:"Current User",email:"user@example.com"}};o(e=>[t,...e]),m.success("Nakdi işlem başarıyla kaydedildi"),F(!1),P(),Q()}catch(t){m.error("Nakdi işlem kaydedilirken hata oluştu")}}),className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"İşlem Türü *"}),e.jsxs("select",{...M("operation_type"),className:"w-full rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Seçiniz..."}),e.jsx("option",{value:"income",children:"Gelir"}),e.jsx("option",{value:"expense",children:"Gider"}),e.jsx("option",{value:"transfer",children:"Transfer"})]}),$.operation_type&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:$.operation_type.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kategori *"}),e.jsxs("select",{...M("category"),className:"w-full rounded border px-3 py-2 text-sm",disabled:!q,children:[e.jsx("option",{value:"",children:"Seçiniz..."}),q&&D[q]?.map(t=>e.jsx("option",{value:t,children:t},t))]}),$.category&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:$.category.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tutar *"}),e.jsx("input",{type:"number",step:"0.01",...M("amount",{valueAsNumber:!0}),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"0.00"}),$.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:$.amount.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Referans Numarası"}),e.jsx("input",{type:"text",...M("reference_number"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"REF001"})]})]}),"transfer"===q&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kaynak Hesap"}),e.jsx("input",{type:"text",...M("from_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Kaynak hesap"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Hesap"}),e.jsx("input",{type:"text",...M("to_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Hedef hesap"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Açıklama *"}),e.jsx("input",{type:"text",...M("description"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem açıklaması"}),$.description&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:$.description.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),e.jsx("textarea",{...M("notes"),rows:3,className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem ile ilgili notlar..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>F(!1),className:"rounded border px-4 py-2 text-sm hover:bg-gray-50",children:"İptal"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[e.jsx(x,{className:"h-4 w-4"}),L?"Güncelle":"Kaydet"]})]})]})]})]})}export{C as default};
