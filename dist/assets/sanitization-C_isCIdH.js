import t from"./purify.es-CC9sp8hv.js";const r={TEXT_ONLY:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1},RICH_TEXT:{allowedTags:["p","br","strong","em","u","ol","ul","li","h1","h2","h3","h4","h5","h6"],allowedAttributes:["class"],stripTags:!1,allowHtml:!0},HTML_WITH_LINKS:{allowedTags:["p","br","strong","em","u","ol","ul","li","h1","h2","h3","h4","h5","h6","a"],allowedAttributes:["class","href","target","rel"],stripTags:!1,allowHtml:!0},EMAIL:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1},PHONE:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1},URL:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1}};function e(e,o=r.TEXT_ONLY){if(!e||"string"!=typeof e)return"";const s={};return o.allowedTags&&(s.ALLOWED_TAGS=o.allowedTags),o.allowedAttributes&&(s.ALLOWED_ATTR=o.allowedAttributes),o.stripTags&&(s.ALLOWED_TAGS=[],s.KEEP_CONTENT=!0),s.FORBID_ATTR=["onerror","onload","onclick","onmouseover","onfocus","onblur"],s.FORBID_TAGS=["script","object","embed","form","input","textarea","select","button"],t.sanitize(e.trim(),s)}function o(t,s=r.TEXT_ONLY){if(!t||"object"!=typeof t)return t;const n={...t};for(const[r,l]of Object.entries(n))"string"==typeof l?n[r]=e(l,s):Array.isArray(l)?n[r]=l.map(t=>"string"==typeof t?e(t,s):"object"==typeof t?o(t,s):t):l&&"object"==typeof l&&(n[r]=o(l,s));return n}function s(t){if(!t||"string"!=typeof t)return"";const o=e(t,r.TEXT_ONLY);return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o)?o:""}function n(t){if(!t||"string"!=typeof t)return"";return e(t,r.TEXT_ONLY).replace(/[^0-9+\-\s()]/g,"")}function l(t){if(!t||"string"!=typeof t)return!1;const r=t.trim();return![/^YOUR_.*_URL$/i,/^PLACEHOLDER/i,/^REPLACE_WITH/i,/^\[.*\]$/,/^<.*>$/,/^\{.*\}$/,/^undefined$/i,/^null$/i,/^\s*$/].some(t=>t.test(r))&&!(r.length<3)}function i(t){if(!t||"string"!=typeof t)return!1;const r=t.trim();if(!l(r))return!1;try{let t;return t=r.startsWith("http://")||r.startsWith("https://")?new URL(r):new URL(r,"http://localhost"),"http:"===t.protocol||"https:"===t.protocol}catch{return!1}}function a(t,r){if(!i(t))return null;try{return r?new URL(t,r):new URL(t)}catch{return null}}function u(t){if(!t||"string"!=typeof t)return"";const o=e(t,r.TEXT_ONLY);if(!l(o))return"";try{let t;if(o.startsWith("http://")||o.startsWith("https://"))t=new URL(o);else{const r="undefined"!=typeof window?window.location.origin:"http://localhost";t=new URL(o,r)}if("http:"===t.protocol||"https:"===t.protocol)return t.toString()}catch{}return""}export{r as S,o as a,s as b,n as c,u as d,a as e,i,e as s};
